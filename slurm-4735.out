ai-gpgpu14
Visible GPUs: 0,1,2,3,4,5,6,7
Using devices: cuda:0 cuda:6
Session log: output/imputation/cuda/session_timemixerpp_20250823T102042.log
🔥 RUN: timemixerpp | physionet_2012 | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=48, N_FEATURES=35)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 10:21:31 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
2025-08-23 10:21:31 [INFO]: You're using dataset physionet_2012, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/physionet_2012
2025-08-23 10:21:31 [INFO]: Dataset physionet_2012 has already been downloaded. Processing directly...
2025-08-23 10:21:31 [INFO]: Dataset physionet_2012 has already been cached. Loading from cache directly...
2025-08-23 10:21:31 [INFO]: Loaded successfully!
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/physionet_2012.py:109: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  X = X.groupby("RecordID").apply(apply_func)
2025-08-23 10:21:37 [WARNING]: Note that physionet_2012 has sparse observations in the time series, hence we don't add additional missing values to the training dataset. 
2025-08-23 10:21:37 [INFO]: 22947 values masked out in the val set as ground truth, take 9.91% of the original observed values
2025-08-23 10:21:37 [INFO]: 28724 values masked out in the test set as ground truth, take 10.08% of the original observed values
2025-08-23 10:21:37 [INFO]: Total sample number: 3997
2025-08-23 10:21:37 [INFO]: Training set size: 2557 (63.97%)
2025-08-23 10:21:37 [INFO]: Validation set size: 640 (16.01%)
2025-08-23 10:21:37 [INFO]: Test set size: 800 (20.02%)
2025-08-23 10:21:37 [INFO]: Number of steps: 48
2025-08-23 10:21:37 [INFO]: Number of features: 37
2025-08-23 10:21:37 [INFO]: Train set missing rate: 79.68%
2025-08-23 10:21:37 [INFO]: Validating set missing rate: 81.65%
2025-08-23 10:21:37 [INFO]: Test set missing rate: 81.96%
✅ Dataset 'physionet_2012' with missing rate 0.1 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.1
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 10:21:37 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 10:21:37 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 10:21:37 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 10:21:37 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 10:21:37 [INFO]: Using customized MAE as the training loss function.
2025-08-23 10:21:37 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 10:21:38 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 10:21:38 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 613,635
 ├─ Trainable parameters: 608,771
 └─ Trainable ratio: 99.21%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 10:22:05 [INFO]: Epoch 001 - training loss (MAE): 1.5178, validation MSE: 1.4361
2025-08-23 10:22:31 [INFO]: Epoch 002 - training loss (MAE): 1.3731, validation MSE: 1.0730
2025-08-23 10:22:56 [INFO]: Epoch 003 - training loss (MAE): 1.3276, validation MSE: 1.1045
2025-08-23 10:23:20 [INFO]: Epoch 004 - training loss (MAE): 1.3168, validation MSE: 1.0798
2025-08-23 10:23:47 [INFO]: Epoch 005 - training loss (MAE): 1.3070, validation MSE: 1.0620
2025-08-23 10:24:14 [INFO]: Epoch 006 - training loss (MAE): 1.2969, validation MSE: 1.0517
2025-08-23 10:24:41 [INFO]: Epoch 007 - training loss (MAE): 1.2955, validation MSE: 1.0542
2025-08-23 10:25:08 [INFO]: Epoch 008 - training loss (MAE): 1.2889, validation MSE: 1.0663
2025-08-23 10:25:34 [INFO]: Epoch 009 - training loss (MAE): 1.2868, validation MSE: 1.0606
2025-08-23 10:26:01 [INFO]: Epoch 010 - training loss (MAE): 1.2852, validation MSE: 1.0582
2025-08-23 10:26:28 [INFO]: Epoch 011 - training loss (MAE): 1.2809, validation MSE: 1.0890
2025-08-23 10:26:28 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 10:26:28 [INFO]: Finished training. The best model is from epoch#6.
2025-08-23 10:26:28 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.4296| MSE: 0.4717| RMSE: 0.6868| MRE: 0.6033|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: physionet_2012 | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): physionet_2012 | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): physionet_2012 | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): physionet_2012 | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | physionet_2012 | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=48, N_FEATURES=35)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 10:26:42 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
2025-08-23 10:26:42 [INFO]: You're using dataset physionet_2012, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/physionet_2012
2025-08-23 10:26:42 [INFO]: Dataset physionet_2012 has already been downloaded. Processing directly...
2025-08-23 10:26:42 [INFO]: Dataset physionet_2012 has already been cached. Loading from cache directly...
2025-08-23 10:26:42 [INFO]: Loaded successfully!
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/physionet_2012.py:109: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  X = X.groupby("RecordID").apply(apply_func)
2025-08-23 10:26:48 [WARNING]: Note that physionet_2012 has sparse observations in the time series, hence we don't add additional missing values to the training dataset. 
2025-08-23 10:26:48 [INFO]: 46041 values masked out in the val set as ground truth, take 19.88% of the original observed values
2025-08-23 10:26:48 [INFO]: 57450 values masked out in the test set as ground truth, take 20.16% of the original observed values
2025-08-23 10:26:48 [INFO]: Total sample number: 3997
2025-08-23 10:26:48 [INFO]: Training set size: 2557 (63.97%)
2025-08-23 10:26:48 [INFO]: Validation set size: 640 (16.01%)
2025-08-23 10:26:48 [INFO]: Test set size: 800 (20.02%)
2025-08-23 10:26:48 [INFO]: Number of steps: 48
2025-08-23 10:26:48 [INFO]: Number of features: 37
2025-08-23 10:26:48 [INFO]: Train set missing rate: 79.68%
2025-08-23 10:26:48 [INFO]: Validating set missing rate: 83.68%
2025-08-23 10:26:48 [INFO]: Test set missing rate: 83.99%
✅ Dataset 'physionet_2012' with missing rate 0.2 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.2
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 10:26:48 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 10:26:48 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 10:26:49 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 10:26:49 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 10:26:49 [INFO]: Using customized MAE as the training loss function.
2025-08-23 10:26:49 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 10:26:49 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 10:26:49 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 613,635
 ├─ Trainable parameters: 608,771
 └─ Trainable ratio: 99.21%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 10:27:16 [INFO]: Epoch 001 - training loss (MAE): 1.5179, validation MSE: 1.3935
2025-08-23 10:27:43 [INFO]: Epoch 002 - training loss (MAE): 1.3731, validation MSE: 1.1024
2025-08-23 10:28:09 [INFO]: Epoch 003 - training loss (MAE): 1.3275, validation MSE: 1.1142
2025-08-23 10:28:35 [INFO]: Epoch 004 - training loss (MAE): 1.3171, validation MSE: 1.1016
2025-08-23 10:29:00 [INFO]: Epoch 005 - training loss (MAE): 1.3070, validation MSE: 1.0659
2025-08-23 10:29:25 [INFO]: Epoch 006 - training loss (MAE): 1.2974, validation MSE: 1.0544
2025-08-23 10:29:51 [INFO]: Epoch 007 - training loss (MAE): 1.2958, validation MSE: 1.0612
2025-08-23 10:30:18 [INFO]: Epoch 008 - training loss (MAE): 1.2892, validation MSE: 1.0672
2025-08-23 10:30:44 [INFO]: Epoch 009 - training loss (MAE): 1.2869, validation MSE: 1.0638
2025-08-23 10:31:11 [INFO]: Epoch 010 - training loss (MAE): 1.2845, validation MSE: 1.0643
2025-08-23 10:31:38 [INFO]: Epoch 011 - training loss (MAE): 1.2801, validation MSE: 1.0726
2025-08-23 10:31:38 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 10:31:38 [INFO]: Finished training. The best model is from epoch#6.
2025-08-23 10:31:38 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.4286| MSE: 0.5000| RMSE: 0.7071| MRE: 0.6051|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: physionet_2012 | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): physionet_2012 | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): physionet_2012 | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): physionet_2012 | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | physionet_2012 | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=48, N_FEATURES=35)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 10:31:51 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 10:31:51 [INFO]: You're using dataset physionet_2012, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/physionet_2012
2025-08-23 10:31:51 [INFO]: Dataset physionet_2012 has already been downloaded. Processing directly...
2025-08-23 10:31:51 [INFO]: Dataset physionet_2012 has already been cached. Loading from cache directly...
2025-08-23 10:31:51 [INFO]: Loaded successfully!
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/physionet_2012.py:109: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  X = X.groupby("RecordID").apply(apply_func)
2025-08-23 10:31:57 [WARNING]: Note that physionet_2012 has sparse observations in the time series, hence we don't add additional missing values to the training dataset. 
2025-08-23 10:31:57 [INFO]: 69227 values masked out in the val set as ground truth, take 29.90% of the original observed values
2025-08-23 10:31:57 [INFO]: 85805 values masked out in the test set as ground truth, take 30.11% of the original observed values
2025-08-23 10:31:57 [INFO]: Total sample number: 3997
2025-08-23 10:31:57 [INFO]: Training set size: 2557 (63.97%)
2025-08-23 10:31:57 [INFO]: Validation set size: 640 (16.01%)
2025-08-23 10:31:57 [INFO]: Test set size: 800 (20.02%)
2025-08-23 10:31:57 [INFO]: Number of steps: 48
2025-08-23 10:31:57 [INFO]: Number of features: 37
2025-08-23 10:31:57 [INFO]: Train set missing rate: 79.68%
2025-08-23 10:31:57 [INFO]: Validating set missing rate: 85.72%
2025-08-23 10:31:57 [INFO]: Test set missing rate: 85.98%
✅ Dataset 'physionet_2012' with missing rate 0.3 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.3
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 10:31:57 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 10:31:57 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 10:31:57 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 10:31:57 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 10:31:57 [INFO]: Using customized MAE as the training loss function.
2025-08-23 10:31:57 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 10:31:58 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 10:31:58 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 613,635
 ├─ Trainable parameters: 608,771
 └─ Trainable ratio: 99.21%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 10:32:31 [INFO]: Epoch 001 - training loss (MAE): 1.5179, validation MSE: 1.4590
2025-08-23 10:33:06 [INFO]: Epoch 002 - training loss (MAE): 1.3737, validation MSE: 1.0836
2025-08-23 10:33:40 [INFO]: Epoch 003 - training loss (MAE): 1.3284, validation MSE: 1.0830
2025-08-23 10:34:12 [INFO]: Epoch 004 - training loss (MAE): 1.3175, validation MSE: 1.0838
2025-08-23 10:34:43 [INFO]: Epoch 005 - training loss (MAE): 1.3063, validation MSE: 1.0464
2025-08-23 10:35:09 [INFO]: Epoch 006 - training loss (MAE): 1.2972, validation MSE: 1.0335
2025-08-23 10:35:39 [INFO]: Epoch 007 - training loss (MAE): 1.2959, validation MSE: 1.0347
2025-08-23 10:36:14 [INFO]: Epoch 008 - training loss (MAE): 1.2887, validation MSE: 1.0476
2025-08-23 10:36:48 [INFO]: Epoch 009 - training loss (MAE): 1.2877, validation MSE: 1.0380
2025-08-23 10:37:20 [INFO]: Epoch 010 - training loss (MAE): 1.2848, validation MSE: 1.0439
2025-08-23 10:37:54 [INFO]: Epoch 011 - training loss (MAE): 1.2813, validation MSE: 1.0640
2025-08-23 10:37:54 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 10:37:54 [INFO]: Finished training. The best model is from epoch#6.
2025-08-23 10:37:54 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.4327| MSE: 0.5022| RMSE: 0.7086| MRE: 0.6123|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: physionet_2012 | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): physionet_2012 | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): physionet_2012 | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): physionet_2012 | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | physionet_2012 | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=48, N_FEATURES=35)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 10:38:13 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 10:38:13 [INFO]: You're using dataset physionet_2012, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/physionet_2012
2025-08-23 10:38:13 [INFO]: Dataset physionet_2012 has already been downloaded. Processing directly...
2025-08-23 10:38:13 [INFO]: Dataset physionet_2012 has already been cached. Loading from cache directly...
2025-08-23 10:38:13 [INFO]: Loaded successfully!
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/physionet_2012.py:109: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  X = X.groupby("RecordID").apply(apply_func)
2025-08-23 10:38:19 [WARNING]: Note that physionet_2012 has sparse observations in the time series, hence we don't add additional missing values to the training dataset. 
2025-08-23 10:38:19 [INFO]: 92507 values masked out in the val set as ground truth, take 39.95% of the original observed values
2025-08-23 10:38:19 [INFO]: 114242 values masked out in the test set as ground truth, take 40.09% of the original observed values
2025-08-23 10:38:19 [INFO]: Total sample number: 3997
2025-08-23 10:38:19 [INFO]: Training set size: 2557 (63.97%)
2025-08-23 10:38:19 [INFO]: Validation set size: 640 (16.01%)
2025-08-23 10:38:19 [INFO]: Test set size: 800 (20.02%)
2025-08-23 10:38:19 [INFO]: Number of steps: 48
2025-08-23 10:38:19 [INFO]: Number of features: 37
2025-08-23 10:38:19 [INFO]: Train set missing rate: 79.68%
2025-08-23 10:38:19 [INFO]: Validating set missing rate: 87.77%
2025-08-23 10:38:19 [INFO]: Test set missing rate: 87.98%
✅ Dataset 'physionet_2012' with missing rate 0.4 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.4
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 10:38:19 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 10:38:19 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 10:38:20 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 10:38:20 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 10:38:20 [INFO]: Using customized MAE as the training loss function.
2025-08-23 10:38:20 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 10:38:20 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 10:38:20 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 613,635
 ├─ Trainable parameters: 608,771
 └─ Trainable ratio: 99.21%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 10:38:52 [INFO]: Epoch 001 - training loss (MAE): 1.5178, validation MSE: 1.4763
2025-08-23 10:39:22 [INFO]: Epoch 002 - training loss (MAE): 1.3732, validation MSE: 1.0866
2025-08-23 10:39:56 [INFO]: Epoch 003 - training loss (MAE): 1.3284, validation MSE: 1.0843
2025-08-23 10:40:29 [INFO]: Epoch 004 - training loss (MAE): 1.3182, validation MSE: 1.0633
2025-08-23 10:41:03 [INFO]: Epoch 005 - training loss (MAE): 1.3082, validation MSE: 1.0336
2025-08-23 10:41:35 [INFO]: Epoch 006 - training loss (MAE): 1.2982, validation MSE: 1.0147
2025-08-23 10:42:10 [INFO]: Epoch 007 - training loss (MAE): 1.2962, validation MSE: 1.0139
2025-08-23 10:42:46 [INFO]: Epoch 008 - training loss (MAE): 1.2898, validation MSE: 1.0253
2025-08-23 10:43:13 [INFO]: Epoch 009 - training loss (MAE): 1.2883, validation MSE: 1.0196
2025-08-23 10:43:46 [INFO]: Epoch 010 - training loss (MAE): 1.2852, validation MSE: 1.0202
2025-08-23 10:44:19 [INFO]: Epoch 011 - training loss (MAE): 1.2807, validation MSE: 1.0316
2025-08-23 10:44:52 [INFO]: Epoch 012 - training loss (MAE): 1.2743, validation MSE: 1.0432
2025-08-23 10:44:52 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 10:44:52 [INFO]: Finished training. The best model is from epoch#7.
2025-08-23 10:44:53 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.4359| MSE: 0.5262| RMSE: 0.7254| MRE: 0.6178|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: physionet_2012 | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): physionet_2012 | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): physionet_2012 | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): physionet_2012 | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | physionet_2012 | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=48, N_FEATURES=35)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 10:45:14 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 10:45:14 [INFO]: You're using dataset physionet_2012, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/physionet_2012
2025-08-23 10:45:14 [INFO]: Dataset physionet_2012 has already been downloaded. Processing directly...
2025-08-23 10:45:14 [INFO]: Dataset physionet_2012 has already been cached. Loading from cache directly...
2025-08-23 10:45:14 [INFO]: Loaded successfully!
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/physionet_2012.py:109: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  X = X.groupby("RecordID").apply(apply_func)
2025-08-23 10:45:23 [WARNING]: Note that physionet_2012 has sparse observations in the time series, hence we don't add additional missing values to the training dataset. 
2025-08-23 10:45:23 [INFO]: 115521 values masked out in the val set as ground truth, take 49.89% of the original observed values
2025-08-23 10:45:23 [INFO]: 142704 values masked out in the test set as ground truth, take 50.08% of the original observed values
2025-08-23 10:45:23 [INFO]: Total sample number: 3997
2025-08-23 10:45:23 [INFO]: Training set size: 2557 (63.97%)
2025-08-23 10:45:23 [INFO]: Validation set size: 640 (16.01%)
2025-08-23 10:45:23 [INFO]: Test set size: 800 (20.02%)
2025-08-23 10:45:23 [INFO]: Number of steps: 48
2025-08-23 10:45:23 [INFO]: Number of features: 37
2025-08-23 10:45:23 [INFO]: Train set missing rate: 79.68%
2025-08-23 10:45:23 [INFO]: Validating set missing rate: 89.79%
2025-08-23 10:45:23 [INFO]: Test set missing rate: 89.99%
✅ Dataset 'physionet_2012' with missing rate 0.5 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.5
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 10:45:23 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 10:45:23 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 10:45:24 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 10:45:24 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 10:45:24 [INFO]: Using customized MAE as the training loss function.
2025-08-23 10:45:24 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 10:45:24 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 10:45:24 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 613,635
 ├─ Trainable parameters: 608,771
 └─ Trainable ratio: 99.21%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 10:45:55 [INFO]: Epoch 001 - training loss (MAE): 1.5178, validation MSE: 1.5649
2025-08-23 10:46:26 [INFO]: Epoch 002 - training loss (MAE): 1.3772, validation MSE: 1.1588
2025-08-23 10:46:55 [INFO]: Epoch 003 - training loss (MAE): 1.3301, validation MSE: 1.1111
2025-08-23 10:47:26 [INFO]: Epoch 004 - training loss (MAE): 1.3157, validation MSE: 1.0839
2025-08-23 10:47:56 [INFO]: Epoch 005 - training loss (MAE): 1.3043, validation MSE: 1.0589
2025-08-23 10:48:28 [INFO]: Epoch 006 - training loss (MAE): 1.2959, validation MSE: 1.0470
2025-08-23 10:48:57 [INFO]: Epoch 007 - training loss (MAE): 1.2955, validation MSE: 1.0441
2025-08-23 10:49:29 [INFO]: Epoch 008 - training loss (MAE): 1.2891, validation MSE: 1.0487
2025-08-23 10:49:55 [INFO]: Epoch 009 - training loss (MAE): 1.2870, validation MSE: 1.0391
2025-08-23 10:50:20 [INFO]: Epoch 010 - training loss (MAE): 1.2834, validation MSE: 1.0412
2025-08-23 10:50:46 [INFO]: Epoch 011 - training loss (MAE): 1.2800, validation MSE: 1.0493
2025-08-23 10:51:12 [INFO]: Epoch 012 - training loss (MAE): 1.2729, validation MSE: 1.0522
2025-08-23 10:51:39 [INFO]: Epoch 013 - training loss (MAE): 1.2715, validation MSE: 1.0650
2025-08-23 10:52:04 [INFO]: Epoch 014 - training loss (MAE): 1.2686, validation MSE: 1.0474
2025-08-23 10:52:04 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 10:52:04 [INFO]: Finished training. The best model is from epoch#9.
2025-08-23 10:52:04 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.4450| MSE: 0.5524| RMSE: 0.7432| MRE: 0.6308|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/physionet_2012/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: physionet_2012 | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): physionet_2012 | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): physionet_2012 | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): physionet_2012 | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | beijing_multisite_air_quality | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=48, N_FEATURES=36)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 10:52:17 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
2025-08-23 10:52:17 [INFO]: You're using dataset beijing_multisite_air_quality, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/beijing_multisite_air_quality
2025-08-23 10:52:17 [INFO]: Dataset beijing_multisite_air_quality has already been downloaded. Processing directly...
2025-08-23 10:52:17 [INFO]: Dataset beijing_multisite_air_quality has already been cached. Loading from cache directly...
2025-08-23 10:52:17 [INFO]: Loaded successfully!
2025-08-23 10:52:17 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:52:17 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:52:17 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:52:17 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:52:17 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:52:17 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:52:17 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:52:17 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:52:17 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:52:17 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:52:17 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:52:17 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:52:17 [INFO]: There are total 12 stations, they are ['Aotizhongxin', 'Changping', 'Dingling', 'Dongsi', 'Guanyuan', 'Gucheng', 'Huairou', 'Nongzhanguan', 'Shunyi', 'Tiantan', 'Wanliu', 'Wanshouxigong']
2025-08-23 10:52:17 [INFO]: Original df missing rate: 0.016
2025-08-23 10:52:17 [INFO]: months selected as train set are <PeriodArray>
['2013-03', '2013-04', '2013-05', '2013-06', '2013-07', '2013-08', '2013-09',
 '2013-10', '2013-11', '2013-12', '2014-01', '2014-02', '2014-03', '2014-04',
 '2014-05', '2014-06', '2014-07', '2014-08', '2014-09', '2014-10', '2014-11',
 '2014-12', '2015-01', '2015-02', '2015-03', '2015-04', '2015-05', '2015-06']
Length: 28, dtype: period[M]
2025-08-23 10:52:17 [INFO]: months selected as val set are <PeriodArray>
['2015-07', '2015-08', '2015-09', '2015-10', '2015-11', '2015-12', '2016-01',
 '2016-02', '2016-03', '2016-04']
Length: 10, dtype: period[M]
2025-08-23 10:52:17 [INFO]: months selected as test set are <PeriodArray>
['2016-05', '2016-06', '2016-07', '2016-08', '2016-09', '2016-10', '2016-11',
 '2016-12', '2017-01', '2017-02']
Length: 10, dtype: period[M]
2025-08-23 10:52:17 [INFO]: Total sample number: 730
2025-08-23 10:52:17 [INFO]: Training set size: 426 (58.36%)
2025-08-23 10:52:17 [INFO]: Validation set size: 152 (20.82%)
2025-08-23 10:52:17 [INFO]: Test set size: 152 (20.82%)
2025-08-23 10:52:17 [INFO]: Number of steps: 48
2025-08-23 10:52:17 [INFO]: Number of features: 132
2025-08-23 10:52:17 [INFO]: Train set missing rate: 11.67%
2025-08-23 10:52:17 [INFO]: Validating set missing rate: 10.80%
2025-08-23 10:52:17 [INFO]: Test set missing rate: 11.13%
✅ Dataset 'beijing_multisite_air_quality' with missing rate 0.1 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.1
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 10:52:17 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 10:52:17 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 10:52:18 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 10:52:18 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 10:52:18 [INFO]: Using customized MAE as the training loss function.
2025-08-23 10:52:18 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 10:52:18 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 10:52:18 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 613,635
 ├─ Trainable parameters: 608,771
 └─ Trainable ratio: 99.21%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 10:52:29 [INFO]: Epoch 001 - training loss (MAE): 1.8363, validation MSE: 1.0079
2025-08-23 10:52:36 [INFO]: Epoch 002 - training loss (MAE): 1.4985, validation MSE: 1.1829
2025-08-23 10:52:44 [INFO]: Epoch 003 - training loss (MAE): 1.4207, validation MSE: 1.2187
2025-08-23 10:52:53 [INFO]: Epoch 004 - training loss (MAE): 1.3869, validation MSE: 1.3012
2025-08-23 10:53:03 [INFO]: Epoch 005 - training loss (MAE): 1.3599, validation MSE: 1.3649
2025-08-23 10:53:12 [INFO]: Epoch 006 - training loss (MAE): 1.3461, validation MSE: 1.4146
2025-08-23 10:53:12 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 10:53:12 [INFO]: Finished training. The best model is from epoch#1.
2025-08-23 10:53:12 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.3021| MSE: 0.4167| RMSE: 0.6455| MRE: 0.4013|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: beijing_multisite_air_quality | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): beijing_multisite_air_quality | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): beijing_multisite_air_quality | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): beijing_multisite_air_quality | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | beijing_multisite_air_quality | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=48, N_FEATURES=36)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 10:53:33 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 10:53:33 [INFO]: You're using dataset beijing_multisite_air_quality, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/beijing_multisite_air_quality
2025-08-23 10:53:33 [INFO]: Dataset beijing_multisite_air_quality has already been downloaded. Processing directly...
2025-08-23 10:53:33 [INFO]: Dataset beijing_multisite_air_quality has already been cached. Loading from cache directly...
2025-08-23 10:53:33 [INFO]: Loaded successfully!
2025-08-23 10:53:33 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:53:33 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:53:33 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:53:34 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:53:34 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:53:34 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:53:34 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:53:34 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:53:34 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:53:34 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:53:34 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:53:34 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:53:34 [INFO]: There are total 12 stations, they are ['Aotizhongxin', 'Changping', 'Dingling', 'Dongsi', 'Guanyuan', 'Gucheng', 'Huairou', 'Nongzhanguan', 'Shunyi', 'Tiantan', 'Wanliu', 'Wanshouxigong']
2025-08-23 10:53:34 [INFO]: Original df missing rate: 0.016
2025-08-23 10:53:34 [INFO]: months selected as train set are <PeriodArray>
['2013-03', '2013-04', '2013-05', '2013-06', '2013-07', '2013-08', '2013-09',
 '2013-10', '2013-11', '2013-12', '2014-01', '2014-02', '2014-03', '2014-04',
 '2014-05', '2014-06', '2014-07', '2014-08', '2014-09', '2014-10', '2014-11',
 '2014-12', '2015-01', '2015-02', '2015-03', '2015-04', '2015-05', '2015-06']
Length: 28, dtype: period[M]
2025-08-23 10:53:34 [INFO]: months selected as val set are <PeriodArray>
['2015-07', '2015-08', '2015-09', '2015-10', '2015-11', '2015-12', '2016-01',
 '2016-02', '2016-03', '2016-04']
Length: 10, dtype: period[M]
2025-08-23 10:53:34 [INFO]: months selected as test set are <PeriodArray>
['2016-05', '2016-06', '2016-07', '2016-08', '2016-09', '2016-10', '2016-11',
 '2016-12', '2017-01', '2017-02']
Length: 10, dtype: period[M]
2025-08-23 10:53:34 [INFO]: Total sample number: 730
2025-08-23 10:53:34 [INFO]: Training set size: 426 (58.36%)
2025-08-23 10:53:34 [INFO]: Validation set size: 152 (20.82%)
2025-08-23 10:53:34 [INFO]: Test set size: 152 (20.82%)
2025-08-23 10:53:34 [INFO]: Number of steps: 48
2025-08-23 10:53:34 [INFO]: Number of features: 132
2025-08-23 10:53:34 [INFO]: Train set missing rate: 21.51%
2025-08-23 10:53:34 [INFO]: Validating set missing rate: 20.70%
2025-08-23 10:53:34 [INFO]: Test set missing rate: 20.98%
✅ Dataset 'beijing_multisite_air_quality' with missing rate 0.2 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.2
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 10:53:34 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 10:53:34 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 10:53:35 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 10:53:35 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 10:53:35 [INFO]: Using customized MAE as the training loss function.
2025-08-23 10:53:35 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 10:53:35 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 10:53:35 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 613,635
 ├─ Trainable parameters: 608,771
 └─ Trainable ratio: 99.21%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 10:53:47 [INFO]: Epoch 001 - training loss (MAE): 1.8392, validation MSE: 1.0081
2025-08-23 10:53:56 [INFO]: Epoch 002 - training loss (MAE): 1.5007, validation MSE: 1.2867
2025-08-23 10:54:05 [INFO]: Epoch 003 - training loss (MAE): 1.4269, validation MSE: 1.2145
2025-08-23 10:54:14 [INFO]: Epoch 004 - training loss (MAE): 1.3907, validation MSE: 1.3451
2025-08-23 10:54:23 [INFO]: Epoch 005 - training loss (MAE): 1.3652, validation MSE: 1.4094
2025-08-23 10:54:32 [INFO]: Epoch 006 - training loss (MAE): 1.3511, validation MSE: 1.3992
2025-08-23 10:54:32 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 10:54:32 [INFO]: Finished training. The best model is from epoch#1.
2025-08-23 10:54:32 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.3134| MSE: 0.4766| RMSE: 0.6903| MRE: 0.4155|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: beijing_multisite_air_quality | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): beijing_multisite_air_quality | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): beijing_multisite_air_quality | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): beijing_multisite_air_quality | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | beijing_multisite_air_quality | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=48, N_FEATURES=36)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 10:55:06 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 10:55:06 [INFO]: You're using dataset beijing_multisite_air_quality, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/beijing_multisite_air_quality
2025-08-23 10:55:06 [INFO]: Dataset beijing_multisite_air_quality has already been downloaded. Processing directly...
2025-08-23 10:55:06 [INFO]: Dataset beijing_multisite_air_quality has already been cached. Loading from cache directly...
2025-08-23 10:55:06 [INFO]: Loaded successfully!
2025-08-23 10:55:06 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:55:07 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:55:07 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:55:07 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:55:07 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:55:07 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:55:07 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:55:07 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:55:07 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:55:07 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:55:07 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:55:07 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:55:07 [INFO]: There are total 12 stations, they are ['Aotizhongxin', 'Changping', 'Dingling', 'Dongsi', 'Guanyuan', 'Gucheng', 'Huairou', 'Nongzhanguan', 'Shunyi', 'Tiantan', 'Wanliu', 'Wanshouxigong']
2025-08-23 10:55:07 [INFO]: Original df missing rate: 0.016
2025-08-23 10:55:07 [INFO]: months selected as train set are <PeriodArray>
['2013-03', '2013-04', '2013-05', '2013-06', '2013-07', '2013-08', '2013-09',
 '2013-10', '2013-11', '2013-12', '2014-01', '2014-02', '2014-03', '2014-04',
 '2014-05', '2014-06', '2014-07', '2014-08', '2014-09', '2014-10', '2014-11',
 '2014-12', '2015-01', '2015-02', '2015-03', '2015-04', '2015-05', '2015-06']
Length: 28, dtype: period[M]
2025-08-23 10:55:07 [INFO]: months selected as val set are <PeriodArray>
['2015-07', '2015-08', '2015-09', '2015-10', '2015-11', '2015-12', '2016-01',
 '2016-02', '2016-03', '2016-04']
Length: 10, dtype: period[M]
2025-08-23 10:55:07 [INFO]: months selected as test set are <PeriodArray>
['2016-05', '2016-06', '2016-07', '2016-08', '2016-09', '2016-10', '2016-11',
 '2016-12', '2017-01', '2017-02']
Length: 10, dtype: period[M]
2025-08-23 10:55:07 [INFO]: Total sample number: 730
2025-08-23 10:55:07 [INFO]: Training set size: 426 (58.36%)
2025-08-23 10:55:07 [INFO]: Validation set size: 152 (20.82%)
2025-08-23 10:55:07 [INFO]: Test set size: 152 (20.82%)
2025-08-23 10:55:07 [INFO]: Number of steps: 48
2025-08-23 10:55:07 [INFO]: Number of features: 132
2025-08-23 10:55:07 [INFO]: Train set missing rate: 31.34%
2025-08-23 10:55:07 [INFO]: Validating set missing rate: 30.61%
2025-08-23 10:55:07 [INFO]: Test set missing rate: 30.86%
✅ Dataset 'beijing_multisite_air_quality' with missing rate 0.3 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.3
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 10:55:07 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 10:55:07 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 10:55:07 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 10:55:07 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 10:55:07 [INFO]: Using customized MAE as the training loss function.
2025-08-23 10:55:07 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 10:55:08 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 10:55:08 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 613,635
 ├─ Trainable parameters: 608,771
 └─ Trainable ratio: 99.21%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 10:55:19 [INFO]: Epoch 001 - training loss (MAE): 1.8394, validation MSE: 1.1110
2025-08-23 10:55:27 [INFO]: Epoch 002 - training loss (MAE): 1.5067, validation MSE: 1.4533
2025-08-23 10:55:36 [INFO]: Epoch 003 - training loss (MAE): 1.4386, validation MSE: 1.1832
2025-08-23 10:55:45 [INFO]: Epoch 004 - training loss (MAE): 1.3983, validation MSE: 1.4732
2025-08-23 10:55:54 [INFO]: Epoch 005 - training loss (MAE): 1.3722, validation MSE: 1.5444
2025-08-23 10:56:04 [INFO]: Epoch 006 - training loss (MAE): 1.3584, validation MSE: 1.4473
2025-08-23 10:56:04 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 10:56:04 [INFO]: Finished training. The best model is from epoch#1.
2025-08-23 10:56:04 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.3304| MSE: 0.5465| RMSE: 0.7392| MRE: 0.4390|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: beijing_multisite_air_quality | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): beijing_multisite_air_quality | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): beijing_multisite_air_quality | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): beijing_multisite_air_quality | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | beijing_multisite_air_quality | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=48, N_FEATURES=36)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 10:56:19 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 10:56:19 [INFO]: You're using dataset beijing_multisite_air_quality, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/beijing_multisite_air_quality
2025-08-23 10:56:19 [INFO]: Dataset beijing_multisite_air_quality has already been downloaded. Processing directly...
2025-08-23 10:56:19 [INFO]: Dataset beijing_multisite_air_quality has already been cached. Loading from cache directly...
2025-08-23 10:56:19 [INFO]: Loaded successfully!
2025-08-23 10:56:20 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:56:20 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:56:20 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:56:20 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:56:20 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:56:20 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:56:20 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:56:20 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:56:20 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:56:20 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:56:20 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:56:20 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:56:20 [INFO]: There are total 12 stations, they are ['Aotizhongxin', 'Changping', 'Dingling', 'Dongsi', 'Guanyuan', 'Gucheng', 'Huairou', 'Nongzhanguan', 'Shunyi', 'Tiantan', 'Wanliu', 'Wanshouxigong']
2025-08-23 10:56:20 [INFO]: Original df missing rate: 0.016
2025-08-23 10:56:20 [INFO]: months selected as train set are <PeriodArray>
['2013-03', '2013-04', '2013-05', '2013-06', '2013-07', '2013-08', '2013-09',
 '2013-10', '2013-11', '2013-12', '2014-01', '2014-02', '2014-03', '2014-04',
 '2014-05', '2014-06', '2014-07', '2014-08', '2014-09', '2014-10', '2014-11',
 '2014-12', '2015-01', '2015-02', '2015-03', '2015-04', '2015-05', '2015-06']
Length: 28, dtype: period[M]
2025-08-23 10:56:20 [INFO]: months selected as val set are <PeriodArray>
['2015-07', '2015-08', '2015-09', '2015-10', '2015-11', '2015-12', '2016-01',
 '2016-02', '2016-03', '2016-04']
Length: 10, dtype: period[M]
2025-08-23 10:56:20 [INFO]: months selected as test set are <PeriodArray>
['2016-05', '2016-06', '2016-07', '2016-08', '2016-09', '2016-10', '2016-11',
 '2016-12', '2017-01', '2017-02']
Length: 10, dtype: period[M]
2025-08-23 10:56:20 [INFO]: Total sample number: 730
2025-08-23 10:56:20 [INFO]: Training set size: 426 (58.36%)
2025-08-23 10:56:20 [INFO]: Validation set size: 152 (20.82%)
2025-08-23 10:56:20 [INFO]: Test set size: 152 (20.82%)
2025-08-23 10:56:20 [INFO]: Number of steps: 48
2025-08-23 10:56:20 [INFO]: Number of features: 132
2025-08-23 10:56:20 [INFO]: Train set missing rate: 41.13%
2025-08-23 10:56:20 [INFO]: Validating set missing rate: 40.51%
2025-08-23 10:56:20 [INFO]: Test set missing rate: 40.77%
✅ Dataset 'beijing_multisite_air_quality' with missing rate 0.4 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.4
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 10:56:20 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 10:56:20 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 10:56:21 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 10:56:21 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 10:56:21 [INFO]: Using customized MAE as the training loss function.
2025-08-23 10:56:21 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 10:56:21 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 10:56:21 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 613,635
 ├─ Trainable parameters: 608,771
 └─ Trainable ratio: 99.21%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 10:56:32 [INFO]: Epoch 001 - training loss (MAE): 1.8396, validation MSE: 1.2164
2025-08-23 10:56:40 [INFO]: Epoch 002 - training loss (MAE): 1.5151, validation MSE: 1.6395
2025-08-23 10:56:49 [INFO]: Epoch 003 - training loss (MAE): 1.4500, validation MSE: 1.1686
2025-08-23 10:56:58 [INFO]: Epoch 004 - training loss (MAE): 1.4071, validation MSE: 1.5556
2025-08-23 10:57:06 [INFO]: Epoch 005 - training loss (MAE): 1.3802, validation MSE: 1.6562
2025-08-23 10:57:16 [INFO]: Epoch 006 - training loss (MAE): 1.3663, validation MSE: 1.4305
2025-08-23 10:57:25 [INFO]: Epoch 007 - training loss (MAE): 1.3522, validation MSE: 1.4099
2025-08-23 10:57:34 [INFO]: Epoch 008 - training loss (MAE): 1.3277, validation MSE: 1.3299
2025-08-23 10:57:34 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 10:57:34 [INFO]: Finished training. The best model is from epoch#3.
2025-08-23 10:57:34 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.3956| MSE: 0.6066| RMSE: 0.7789| MRE: 0.5260|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: beijing_multisite_air_quality | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): beijing_multisite_air_quality | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): beijing_multisite_air_quality | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): beijing_multisite_air_quality | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | beijing_multisite_air_quality | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=48, N_FEATURES=36)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 10:58:02 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
2025-08-23 10:58:02 [INFO]: You're using dataset beijing_multisite_air_quality, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/beijing_multisite_air_quality
2025-08-23 10:58:02 [INFO]: Dataset beijing_multisite_air_quality has already been downloaded. Processing directly...
2025-08-23 10:58:02 [INFO]: Dataset beijing_multisite_air_quality has already been cached. Loading from cache directly...
2025-08-23 10:58:02 [INFO]: Loaded successfully!
2025-08-23 10:58:02 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:58:02 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:58:02 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:58:02 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:58:02 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:58:03 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:58:03 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:58:03 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:58:03 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:58:03 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:58:03 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:58:03 [INFO]: Current dataframe shape: (35064, 18)
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/beijing_multisite_air_quality.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  current_df["date_time"] = pd.to_datetime(
2025-08-23 10:58:03 [INFO]: There are total 12 stations, they are ['Aotizhongxin', 'Changping', 'Dingling', 'Dongsi', 'Guanyuan', 'Gucheng', 'Huairou', 'Nongzhanguan', 'Shunyi', 'Tiantan', 'Wanliu', 'Wanshouxigong']
2025-08-23 10:58:03 [INFO]: Original df missing rate: 0.016
2025-08-23 10:58:03 [INFO]: months selected as train set are <PeriodArray>
['2013-03', '2013-04', '2013-05', '2013-06', '2013-07', '2013-08', '2013-09',
 '2013-10', '2013-11', '2013-12', '2014-01', '2014-02', '2014-03', '2014-04',
 '2014-05', '2014-06', '2014-07', '2014-08', '2014-09', '2014-10', '2014-11',
 '2014-12', '2015-01', '2015-02', '2015-03', '2015-04', '2015-05', '2015-06']
Length: 28, dtype: period[M]
2025-08-23 10:58:03 [INFO]: months selected as val set are <PeriodArray>
['2015-07', '2015-08', '2015-09', '2015-10', '2015-11', '2015-12', '2016-01',
 '2016-02', '2016-03', '2016-04']
Length: 10, dtype: period[M]
2025-08-23 10:58:03 [INFO]: months selected as test set are <PeriodArray>
['2016-05', '2016-06', '2016-07', '2016-08', '2016-09', '2016-10', '2016-11',
 '2016-12', '2017-01', '2017-02']
Length: 10, dtype: period[M]
2025-08-23 10:58:03 [INFO]: Total sample number: 730
2025-08-23 10:58:03 [INFO]: Training set size: 426 (58.36%)
2025-08-23 10:58:03 [INFO]: Validation set size: 152 (20.82%)
2025-08-23 10:58:03 [INFO]: Test set size: 152 (20.82%)
2025-08-23 10:58:03 [INFO]: Number of steps: 48
2025-08-23 10:58:03 [INFO]: Number of features: 132
2025-08-23 10:58:03 [INFO]: Train set missing rate: 50.93%
2025-08-23 10:58:03 [INFO]: Validating set missing rate: 50.44%
2025-08-23 10:58:03 [INFO]: Test set missing rate: 50.71%
✅ Dataset 'beijing_multisite_air_quality' with missing rate 0.5 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.5
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 10:58:03 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 10:58:03 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 10:58:04 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 10:58:04 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 10:58:04 [INFO]: Using customized MAE as the training loss function.
2025-08-23 10:58:04 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 10:58:04 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 10:58:04 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 613,635
 ├─ Trainable parameters: 608,771
 └─ Trainable ratio: 99.21%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 10:58:16 [INFO]: Epoch 001 - training loss (MAE): 1.8382, validation MSE: 1.3332
2025-08-23 10:58:26 [INFO]: Epoch 002 - training loss (MAE): 1.5264, validation MSE: 1.8159
2025-08-23 10:58:36 [INFO]: Epoch 003 - training loss (MAE): 1.4670, validation MSE: 1.1236
2025-08-23 10:58:45 [INFO]: Epoch 004 - training loss (MAE): 1.4212, validation MSE: 1.5460
2025-08-23 10:58:55 [INFO]: Epoch 005 - training loss (MAE): 1.3917, validation MSE: 1.7835
2025-08-23 10:59:05 [INFO]: Epoch 006 - training loss (MAE): 1.3774, validation MSE: 1.4318
2025-08-23 10:59:15 [INFO]: Epoch 007 - training loss (MAE): 1.3649, validation MSE: 1.3763
2025-08-23 10:59:24 [INFO]: Epoch 008 - training loss (MAE): 1.3392, validation MSE: 1.4434
2025-08-23 10:59:24 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 10:59:24 [INFO]: Finished training. The best model is from epoch#3.
2025-08-23 10:59:24 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.3881| MSE: 0.6061| RMSE: 0.7785| MRE: 0.5158|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/beijing_multisite_air_quality/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: beijing_multisite_air_quality | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): beijing_multisite_air_quality | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): beijing_multisite_air_quality | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): beijing_multisite_air_quality | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | italy_air_quality | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=48, N_FEATURES=36)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
🚀 Running imputation pipeline for model: timemixerpp
2025-08-23 10:59:38 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 10:59:38 [INFO]: You're using dataset italy_air_quality, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/italy_air_quality
2025-08-23 10:59:38 [INFO]: Dataset italy_air_quality has already been downloaded. Processing directly...
2025-08-23 10:59:38 [INFO]: Dataset italy_air_quality has already been cached. Loading from cache directly...
2025-08-23 10:59:38 [INFO]: Loaded successfully!
✅ Dataset 'italy_air_quality' with missing rate 0.1 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.1
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 10:59:38 [INFO]: Total sample number: 192
2025-08-23 10:59:38 [INFO]: Training set size: 116 (60.42%)
2025-08-23 10:59:38 [INFO]: Validation set size: 38 (19.79%)
2025-08-23 10:59:38 [INFO]: Test set size: 38 (19.79%)
2025-08-23 10:59:38 [INFO]: Number of steps: 48
2025-08-23 10:59:38 [INFO]: Number of features: 13
2025-08-23 10:59:38 [INFO]: Train set missing rate: 9.87%
2025-08-23 10:59:38 [INFO]: Validating set missing rate: 9.86%
2025-08-23 10:59:38 [INFO]: Test set missing rate: 9.87%
2025-08-23 10:59:38 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 10:59:38 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 10:59:38 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 10:59:38 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 10:59:38 [INFO]: Using customized MAE as the training loss function.
2025-08-23 10:59:38 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 10:59:38 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 10:59:38 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 613,635
 ├─ Trainable parameters: 608,771
 └─ Trainable ratio: 99.21%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 10:59:42 [INFO]: Epoch 001 - training loss (MAE): 2.1816, validation MSE: 1.5595
2025-08-23 10:59:43 [INFO]: Epoch 002 - training loss (MAE): 1.7455, validation MSE: 1.3583
2025-08-23 10:59:44 [INFO]: Epoch 003 - training loss (MAE): 1.5493, validation MSE: 1.5507
2025-08-23 10:59:46 [INFO]: Epoch 004 - training loss (MAE): 1.4843, validation MSE: 1.1635
2025-08-23 10:59:47 [INFO]: Epoch 005 - training loss (MAE): 1.3833, validation MSE: 1.4631
2025-08-23 10:59:49 [INFO]: Epoch 006 - training loss (MAE): 1.3463, validation MSE: 1.7244
2025-08-23 10:59:50 [INFO]: Epoch 007 - training loss (MAE): 1.3027, validation MSE: 1.7032
2025-08-23 10:59:51 [INFO]: Epoch 008 - training loss (MAE): 1.2599, validation MSE: 1.7271
2025-08-23 10:59:53 [INFO]: Epoch 009 - training loss (MAE): 1.2469, validation MSE: 2.0101
2025-08-23 10:59:53 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 10:59:53 [INFO]: Finished training. The best model is from epoch#4.
2025-08-23 10:59:53 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.3204| MSE: 0.3563| RMSE: 0.5969| MRE: 0.4169|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: italy_air_quality | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): italy_air_quality | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): italy_air_quality | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): italy_air_quality | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | italy_air_quality | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=48, N_FEATURES=36)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 11:00:06 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:00:06 [INFO]: You're using dataset italy_air_quality, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/italy_air_quality
2025-08-23 11:00:06 [INFO]: Dataset italy_air_quality has already been downloaded. Processing directly...
2025-08-23 11:00:06 [INFO]: Dataset italy_air_quality has already been cached. Loading from cache directly...
2025-08-23 11:00:06 [INFO]: Loaded successfully!
2025-08-23 11:00:06 [INFO]: Total sample number: 192
2025-08-23 11:00:06 [INFO]: Training set size: 116 (60.42%)
2025-08-23 11:00:06 [INFO]: Validation set size: 38 (19.79%)
2025-08-23 11:00:06 [INFO]: Test set size: 38 (19.79%)
2025-08-23 11:00:06 [INFO]: Number of steps: 48
2025-08-23 11:00:06 [INFO]: Number of features: 13
2025-08-23 11:00:06 [INFO]: Train set missing rate: 19.79%
2025-08-23 11:00:06 [INFO]: Validating set missing rate: 19.86%
2025-08-23 11:00:06 [INFO]: Test set missing rate: 19.88%
✅ Dataset 'italy_air_quality' with missing rate 0.2 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.2
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:00:06 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:00:06 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:00:06 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:00:06 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:00:06 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:00:06 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:00:06 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:00:06 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 613,635
 ├─ Trainable parameters: 608,771
 └─ Trainable ratio: 99.21%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 11:00:09 [INFO]: Epoch 001 - training loss (MAE): 2.1891, validation MSE: 1.8792
2025-08-23 11:00:11 [INFO]: Epoch 002 - training loss (MAE): 1.7425, validation MSE: 1.5893
2025-08-23 11:00:12 [INFO]: Epoch 003 - training loss (MAE): 1.5451, validation MSE: 1.6379
2025-08-23 11:00:13 [INFO]: Epoch 004 - training loss (MAE): 1.4909, validation MSE: 1.3469
2025-08-23 11:00:14 [INFO]: Epoch 005 - training loss (MAE): 1.3937, validation MSE: 1.8904
2025-08-23 11:00:15 [INFO]: Epoch 006 - training loss (MAE): 1.3549, validation MSE: 2.2927
2025-08-23 11:00:17 [INFO]: Epoch 007 - training loss (MAE): 1.3187, validation MSE: 2.2445
2025-08-23 11:00:18 [INFO]: Epoch 008 - training loss (MAE): 1.2799, validation MSE: 2.1810
2025-08-23 11:00:19 [INFO]: Epoch 009 - training loss (MAE): 1.2632, validation MSE: 2.4294
2025-08-23 11:00:19 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 11:00:19 [INFO]: Finished training. The best model is from epoch#4.
2025-08-23 11:00:19 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.3439| MSE: 0.4147| RMSE: 0.6440| MRE: 0.4438|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: italy_air_quality | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): italy_air_quality | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): italy_air_quality | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): italy_air_quality | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | italy_air_quality | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=48, N_FEATURES=36)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 11:00:33 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:00:33 [INFO]: You're using dataset italy_air_quality, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/italy_air_quality
2025-08-23 11:00:33 [INFO]: Dataset italy_air_quality has already been downloaded. Processing directly...
2025-08-23 11:00:33 [INFO]: Dataset italy_air_quality has already been cached. Loading from cache directly...
2025-08-23 11:00:33 [INFO]: Loaded successfully!
2025-08-23 11:00:33 [INFO]: Total sample number: 192
2025-08-23 11:00:33 [INFO]: Training set size: 116 (60.42%)
2025-08-23 11:00:33 [INFO]: Validation set size: 38 (19.79%)
2025-08-23 11:00:33 [INFO]: Test set size: 38 (19.79%)
2025-08-23 11:00:33 [INFO]: Number of steps: 48
2025-08-23 11:00:33 [INFO]: Number of features: 13
2025-08-23 11:00:33 [INFO]: Train set missing rate: 29.80%
2025-08-23 11:00:33 [INFO]: Validating set missing rate: 29.90%
2025-08-23 11:00:33 [INFO]: Test set missing rate: 30.05%
✅ Dataset 'italy_air_quality' with missing rate 0.3 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.3
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:00:33 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:00:33 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:00:34 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:00:34 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:00:34 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:00:34 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:00:34 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:00:34 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 613,635
 ├─ Trainable parameters: 608,771
 └─ Trainable ratio: 99.21%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 11:00:38 [INFO]: Epoch 001 - training loss (MAE): 2.2035, validation MSE: 2.0736
2025-08-23 11:00:39 [INFO]: Epoch 002 - training loss (MAE): 1.7521, validation MSE: 1.8896
2025-08-23 11:00:40 [INFO]: Epoch 003 - training loss (MAE): 1.5506, validation MSE: 1.8146
2025-08-23 11:00:41 [INFO]: Epoch 004 - training loss (MAE): 1.5011, validation MSE: 1.7229
2025-08-23 11:00:43 [INFO]: Epoch 005 - training loss (MAE): 1.4054, validation MSE: 2.2554
2025-08-23 11:00:44 [INFO]: Epoch 006 - training loss (MAE): 1.3681, validation MSE: 2.5999
2025-08-23 11:00:45 [INFO]: Epoch 007 - training loss (MAE): 1.3358, validation MSE: 2.4536
2025-08-23 11:00:46 [INFO]: Epoch 008 - training loss (MAE): 1.3044, validation MSE: 2.2969
2025-08-23 11:00:48 [INFO]: Epoch 009 - training loss (MAE): 1.2835, validation MSE: 2.4222
2025-08-23 11:00:48 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 11:00:48 [INFO]: Finished training. The best model is from epoch#4.
2025-08-23 11:00:48 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.3671| MSE: 0.4777| RMSE: 0.6911| MRE: 0.4697|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: italy_air_quality | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): italy_air_quality | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): italy_air_quality | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): italy_air_quality | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | italy_air_quality | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=48, N_FEATURES=36)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 11:01:00 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:01:00 [INFO]: You're using dataset italy_air_quality, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/italy_air_quality
2025-08-23 11:01:00 [INFO]: Dataset italy_air_quality has already been downloaded. Processing directly...
2025-08-23 11:01:00 [INFO]: Dataset italy_air_quality has already been cached. Loading from cache directly...
2025-08-23 11:01:00 [INFO]: Loaded successfully!
2025-08-23 11:01:00 [INFO]: Total sample number: 192
2025-08-23 11:01:00 [INFO]: Training set size: 116 (60.42%)
2025-08-23 11:01:00 [INFO]: Validation set size: 38 (19.79%)
2025-08-23 11:01:00 [INFO]: Test set size: 38 (19.79%)
2025-08-23 11:01:00 [INFO]: Number of steps: 48
2025-08-23 11:01:00 [INFO]: Number of features: 13
2025-08-23 11:01:00 [INFO]: Train set missing rate: 39.84%
2025-08-23 11:01:00 [INFO]: Validating set missing rate: 39.87%
2025-08-23 11:01:00 [INFO]: Test set missing rate: 40.52%
✅ Dataset 'italy_air_quality' with missing rate 0.4 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.4
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:01:00 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:01:00 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:01:00 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:01:00 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:01:00 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:01:00 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:01:01 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:01:01 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 613,635
 ├─ Trainable parameters: 608,771
 └─ Trainable ratio: 99.21%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 11:01:04 [INFO]: Epoch 001 - training loss (MAE): 2.2222, validation MSE: 2.3027
2025-08-23 11:01:05 [INFO]: Epoch 002 - training loss (MAE): 1.7544, validation MSE: 2.2454
2025-08-23 11:01:06 [INFO]: Epoch 003 - training loss (MAE): 1.5453, validation MSE: 2.1327
2025-08-23 11:01:08 [INFO]: Epoch 004 - training loss (MAE): 1.5190, validation MSE: 2.0625
2025-08-23 11:01:09 [INFO]: Epoch 005 - training loss (MAE): 1.4314, validation MSE: 2.6539
2025-08-23 11:01:10 [INFO]: Epoch 006 - training loss (MAE): 1.3911, validation MSE: 2.9177
2025-08-23 11:01:11 [INFO]: Epoch 007 - training loss (MAE): 1.3630, validation MSE: 2.6435
2025-08-23 11:01:12 [INFO]: Epoch 008 - training loss (MAE): 1.3324, validation MSE: 2.3052
2025-08-23 11:01:14 [INFO]: Epoch 009 - training loss (MAE): 1.3061, validation MSE: 2.2992
2025-08-23 11:01:14 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 11:01:14 [INFO]: Finished training. The best model is from epoch#4.
2025-08-23 11:01:14 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.4081| MSE: 0.6085| RMSE: 0.7801| MRE: 0.5238|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: italy_air_quality | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): italy_air_quality | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): italy_air_quality | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): italy_air_quality | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | italy_air_quality | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=48, N_FEATURES=36)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 11:01:26 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:01:26 [INFO]: You're using dataset italy_air_quality, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/italy_air_quality
2025-08-23 11:01:26 [INFO]: Dataset italy_air_quality has already been downloaded. Processing directly...
2025-08-23 11:01:26 [INFO]: Dataset italy_air_quality has already been cached. Loading from cache directly...
2025-08-23 11:01:26 [INFO]: Loaded successfully!
2025-08-23 11:01:26 [INFO]: Total sample number: 192
2025-08-23 11:01:26 [INFO]: Training set size: 116 (60.42%)
2025-08-23 11:01:26 [INFO]: Validation set size: 38 (19.79%)
2025-08-23 11:01:26 [INFO]: Test set size: 38 (19.79%)
2025-08-23 11:01:26 [INFO]: Number of steps: 48
2025-08-23 11:01:26 [INFO]: Number of features: 13
2025-08-23 11:01:26 [INFO]: Train set missing rate: 50.11%
2025-08-23 11:01:26 [INFO]: Validating set missing rate: 50.03%
2025-08-23 11:01:26 [INFO]: Test set missing rate: 50.12%
✅ Dataset 'italy_air_quality' with missing rate 0.5 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.5
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:01:26 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:01:26 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:01:26 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:01:26 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:01:26 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:01:26 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:01:26 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:01:26 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 613,635
 ├─ Trainable parameters: 608,771
 └─ Trainable ratio: 99.21%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 11:01:30 [INFO]: Epoch 001 - training loss (MAE): 2.2309, validation MSE: 2.7081
2025-08-23 11:01:31 [INFO]: Epoch 002 - training loss (MAE): 1.7653, validation MSE: 2.8205
2025-08-23 11:01:32 [INFO]: Epoch 003 - training loss (MAE): 1.5554, validation MSE: 2.6541
2025-08-23 11:01:33 [INFO]: Epoch 004 - training loss (MAE): 1.5370, validation MSE: 2.5633
2025-08-23 11:01:34 [INFO]: Epoch 005 - training loss (MAE): 1.4671, validation MSE: 3.0435
2025-08-23 11:01:36 [INFO]: Epoch 006 - training loss (MAE): 1.4208, validation MSE: 3.1596
2025-08-23 11:01:37 [INFO]: Epoch 007 - training loss (MAE): 1.3979, validation MSE: 2.7282
2025-08-23 11:01:38 [INFO]: Epoch 008 - training loss (MAE): 1.3640, validation MSE: 2.2489
2025-08-23 11:01:39 [INFO]: Epoch 009 - training loss (MAE): 1.3405, validation MSE: 2.1547
2025-08-23 11:01:40 [INFO]: Epoch 010 - training loss (MAE): 1.3181, validation MSE: 2.2986
2025-08-23 11:01:41 [INFO]: Epoch 011 - training loss (MAE): 1.3016, validation MSE: 2.6026
2025-08-23 11:01:42 [INFO]: Epoch 012 - training loss (MAE): 1.2837, validation MSE: 2.9483
2025-08-23 11:01:43 [INFO]: Epoch 013 - training loss (MAE): 1.2757, validation MSE: 3.2418
2025-08-23 11:01:44 [INFO]: Epoch 014 - training loss (MAE): 1.2574, validation MSE: 3.4908
2025-08-23 11:01:44 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 11:01:44 [INFO]: Finished training. The best model is from epoch#9.
2025-08-23 11:01:44 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.4328| MSE: 0.7334| RMSE: 0.8564| MRE: 0.5574|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/italy_air_quality/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: italy_air_quality | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): italy_air_quality | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): italy_air_quality | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): italy_air_quality | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | pems_traffic | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=96, N_FEATURES=228)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 11:01:51 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:01:51 [INFO]: You're using dataset pems_traffic, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/pems_traffic
2025-08-23 11:01:51 [INFO]: Dataset pems_traffic has already been downloaded. Processing directly...
2025-08-23 11:01:51 [INFO]: Dataset pems_traffic has already been cached. Loading from cache directly...
2025-08-23 11:01:52 [INFO]: Loaded successfully!
2025-08-23 11:01:52 [INFO]: months selected as train set are <PeriodArray>
['2015-01', '2015-02', '2015-03', '2015-04', '2015-05', '2015-06', '2015-07',
 '2015-08', '2015-09', '2015-10', '2015-11', '2015-12', '2016-01', '2016-02',
 '2016-03']
Length: 15, dtype: period[M]
2025-08-23 11:01:52 [INFO]: months selected as val set are <PeriodArray>
['2016-04', '2016-05', '2016-06', '2016-07']
Length: 4, dtype: period[M]
2025-08-23 11:01:52 [INFO]: months selected as test set are <PeriodArray>
['2016-08', '2016-09', '2016-10', '2016-11', '2016-12']
Length: 5, dtype: period[M]
2025-08-23 11:01:52 [INFO]: Total sample number: 182
2025-08-23 11:01:52 [INFO]: Training set size: 114 (62.64%)
2025-08-23 11:01:52 [INFO]: Validation set size: 30 (16.48%)
2025-08-23 11:01:52 [INFO]: Test set size: 38 (20.88%)
2025-08-23 11:01:52 [INFO]: Number of steps: 96
2025-08-23 11:01:52 [INFO]: Number of features: 862
2025-08-23 11:01:52 [INFO]: Train set missing rate: 9.98%
2025-08-23 11:01:52 [INFO]: Validating set missing rate: 10.03%
2025-08-23 11:01:52 [INFO]: Test set missing rate: 10.00%
✅ Dataset 'pems_traffic' with missing rate 0.1 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.1
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:01:52 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:01:52 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:01:53 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:01:53 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:01:53 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:01:53 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:01:53 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:01:53 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 641,283
 ├─ Trainable parameters: 636,419
 └─ Trainable ratio: 99.24%
2025-08-23 11:01:57 [ERROR]: ❌ Exception: Caught OutOfMemoryError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py", line 96, in _worker
    output = module(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/imputation/timemixerpp/core.py", line 82, in forward
    reconstruction = self.model.imputation(X, None)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/backbone.py", line 333, in imputation
    enc_out_list = self.encoder_model[i](enc_out_list)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 205, in forward
    season, trend = self.dual_axis_attn(out)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 235, in dual_axis_attn
    season = self.col_attn_2d_season(out)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 87, in forward
    out = self.gamma * out + x
          ~~~~~~~~~~~^~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 324.00 MiB. GPU 0 has a total capacity of 23.58 GiB of which 105.75 MiB is free. Process 1428406 has 7.31 GiB memory in use. Including non-PyTorch memory, this process has 16.15 GiB memory in use. Of the allocated memory 15.49 GiB is allocated by PyTorch, and 265.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

Traceback (most recent call last):
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/base.py", line 748, in _train_model
    results = self.model(inputs, calc_criterion=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/data_parallel.py", line 193, in forward
    outputs = self.parallel_apply(replicas, inputs, module_kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/data_parallel.py", line 212, in parallel_apply
    return parallel_apply(
           ^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py", line 126, in parallel_apply
    output.reraise()
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/_utils.py", line 715, in reraise
    raise exception
torch.OutOfMemoryError: Caught OutOfMemoryError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py", line 96, in _worker
    output = module(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/imputation/timemixerpp/core.py", line 82, in forward
    reconstruction = self.model.imputation(X, None)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/backbone.py", line 333, in imputation
    enc_out_list = self.encoder_model[i](enc_out_list)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 205, in forward
    season, trend = self.dual_axis_attn(out)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 235, in dual_axis_attn
    season = self.col_attn_2d_season(out)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 87, in forward
    out = self.gamma * out + x
          ~~~~~~~~~~~^~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 324.00 MiB. GPU 0 has a total capacity of 23.58 GiB of which 105.75 MiB is free. Process 1428406 has 7.31 GiB memory in use. Including non-PyTorch memory, this process has 16.15 GiB memory in use. Of the allocated memory 15.49 GiB is allocated by PyTorch, and 265.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/23r8105_messou/lab/iPyPOTS/main.py", line 80, in <module>
    main(args)
  File "/home/23r8105_messou/lab/iPyPOTS/main.py", line 59, in main
    mae, mse, rmse, mre = MODEL_PIPELINES[model_name](dataset, args)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pipeline/imputations/timemixerpp.py", line 64, in train_and_evaluate_timemixerpp
    model.fit(train_set=train_set, val_set=val_set)
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/imputation/timemixerpp/model.py", line 270, in fit
    self._train_model(train_dataloader, val_dataloader)
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/base.py", line 825, in _train_model
    raise RuntimeError(
RuntimeError: Training got interrupted. Model was not trained. Please investigate the error printed above.
srun: error: ai-gpgpu14: task 0: Exited with exit code 1
❌ FAIL(1): pems_traffic | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
🔥 RUN: timemixerpp | pems_traffic | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=96, N_FEATURES=228)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 11:02:14 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:02:14 [INFO]: You're using dataset pems_traffic, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/pems_traffic
2025-08-23 11:02:14 [INFO]: Dataset pems_traffic has already been downloaded. Processing directly...
2025-08-23 11:02:14 [INFO]: Dataset pems_traffic has already been cached. Loading from cache directly...
2025-08-23 11:02:14 [INFO]: Loaded successfully!
2025-08-23 11:02:14 [INFO]: months selected as train set are <PeriodArray>
['2015-01', '2015-02', '2015-03', '2015-04', '2015-05', '2015-06', '2015-07',
 '2015-08', '2015-09', '2015-10', '2015-11', '2015-12', '2016-01', '2016-02',
 '2016-03']
Length: 15, dtype: period[M]
2025-08-23 11:02:14 [INFO]: months selected as val set are <PeriodArray>
['2016-04', '2016-05', '2016-06', '2016-07']
Length: 4, dtype: period[M]
2025-08-23 11:02:14 [INFO]: months selected as test set are <PeriodArray>
['2016-08', '2016-09', '2016-10', '2016-11', '2016-12']
Length: 5, dtype: period[M]
2025-08-23 11:02:14 [INFO]: Total sample number: 182
2025-08-23 11:02:14 [INFO]: Training set size: 114 (62.64%)
2025-08-23 11:02:14 [INFO]: Validation set size: 30 (16.48%)
2025-08-23 11:02:14 [INFO]: Test set size: 38 (20.88%)
2025-08-23 11:02:14 [INFO]: Number of steps: 96
2025-08-23 11:02:14 [INFO]: Number of features: 862
2025-08-23 11:02:14 [INFO]: Train set missing rate: 9.98%
2025-08-23 11:02:14 [INFO]: Validating set missing rate: 10.03%
2025-08-23 11:02:14 [INFO]: Test set missing rate: 10.00%
✅ Dataset 'pems_traffic' with missing rate 0.1 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.1
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:02:14 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:02:14 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:02:15 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:02:15 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:02:15 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:02:15 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:02:15 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:02:15 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 862,560
 ├─ Trainable parameters: 857,696
 └─ Trainable ratio: 99.44%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 11:02:22 [INFO]: Epoch 001 - training loss (MAE): 1.7748, validation MSE: 2.6700
2025-08-23 11:02:26 [INFO]: Epoch 002 - training loss (MAE): 1.6708, validation MSE: 2.4575
2025-08-23 11:02:31 [INFO]: Epoch 003 - training loss (MAE): 1.6025, validation MSE: 2.3109
2025-08-23 11:02:37 [INFO]: Epoch 004 - training loss (MAE): 1.5439, validation MSE: 2.1816
2025-08-23 11:02:44 [INFO]: Epoch 005 - training loss (MAE): 1.4755, validation MSE: 2.0476
2025-08-23 11:02:54 [INFO]: Epoch 006 - training loss (MAE): 1.3962, validation MSE: 1.9275
2025-08-23 11:03:06 [INFO]: Epoch 007 - training loss (MAE): 1.3273, validation MSE: 1.8215
2025-08-23 11:03:19 [INFO]: Epoch 008 - training loss (MAE): 1.2719, validation MSE: 1.7816
2025-08-23 11:03:30 [INFO]: Epoch 009 - training loss (MAE): 1.2258, validation MSE: 1.7136
2025-08-23 11:03:43 [INFO]: Epoch 010 - training loss (MAE): 1.2026, validation MSE: 1.6811
2025-08-23 11:03:55 [INFO]: Epoch 011 - training loss (MAE): 1.1849, validation MSE: 1.6541
2025-08-23 11:04:04 [INFO]: Epoch 012 - training loss (MAE): 1.1748, validation MSE: 1.6778
2025-08-23 11:04:12 [INFO]: Epoch 013 - training loss (MAE): 1.1625, validation MSE: 1.6751
2025-08-23 11:04:21 [INFO]: Epoch 014 - training loss (MAE): 1.1563, validation MSE: 1.6524
2025-08-23 11:04:26 [INFO]: Epoch 015 - training loss (MAE): 1.1477, validation MSE: 1.6424
2025-08-23 11:04:26 [INFO]: Finished training. The best model is from epoch#15.
2025-08-23 11:04:26 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.5538| MSE: 1.0995| RMSE: 1.0486| MRE: 0.6868|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: pems_traffic | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): pems_traffic | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): pems_traffic | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | pems_traffic | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=96, N_FEATURES=228)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 11:04:41 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:04:41 [INFO]: You're using dataset pems_traffic, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/pems_traffic
2025-08-23 11:04:41 [INFO]: Dataset pems_traffic has already been downloaded. Processing directly...
2025-08-23 11:04:41 [INFO]: Dataset pems_traffic has already been cached. Loading from cache directly...
2025-08-23 11:04:41 [INFO]: Loaded successfully!
2025-08-23 11:04:41 [INFO]: months selected as train set are <PeriodArray>
['2015-01', '2015-02', '2015-03', '2015-04', '2015-05', '2015-06', '2015-07',
 '2015-08', '2015-09', '2015-10', '2015-11', '2015-12', '2016-01', '2016-02',
 '2016-03']
Length: 15, dtype: period[M]
2025-08-23 11:04:41 [INFO]: months selected as val set are <PeriodArray>
['2016-04', '2016-05', '2016-06', '2016-07']
Length: 4, dtype: period[M]
2025-08-23 11:04:41 [INFO]: months selected as test set are <PeriodArray>
['2016-08', '2016-09', '2016-10', '2016-11', '2016-12']
Length: 5, dtype: period[M]
2025-08-23 11:04:41 [INFO]: Total sample number: 182
2025-08-23 11:04:41 [INFO]: Training set size: 114 (62.64%)
2025-08-23 11:04:41 [INFO]: Validation set size: 30 (16.48%)
2025-08-23 11:04:41 [INFO]: Test set size: 38 (20.88%)
2025-08-23 11:04:41 [INFO]: Number of steps: 96
2025-08-23 11:04:41 [INFO]: Number of features: 862
2025-08-23 11:04:41 [INFO]: Train set missing rate: 20.00%
2025-08-23 11:04:41 [INFO]: Validating set missing rate: 20.00%
2025-08-23 11:04:41 [INFO]: Test set missing rate: 20.01%
✅ Dataset 'pems_traffic' with missing rate 0.2 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.2
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:04:41 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:04:41 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:04:42 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:04:42 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:04:42 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:04:42 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:04:42 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:04:42 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 641,283
 ├─ Trainable parameters: 636,419
 └─ Trainable ratio: 99.24%
2025-08-23 11:04:45 [ERROR]: ❌ Exception: Caught OutOfMemoryError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py", line 96, in _worker
    output = module(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/imputation/timemixerpp/core.py", line 82, in forward
    reconstruction = self.model.imputation(X, None)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/backbone.py", line 333, in imputation
    enc_out_list = self.encoder_model[i](enc_out_list)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 205, in forward
    season, trend = self.dual_axis_attn(out)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 235, in dual_axis_attn
    season = self.col_attn_2d_season(out)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 87, in forward
    out = self.gamma * out + x
          ~~~~~~~~~~~^~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 324.00 MiB. GPU 0 has a total capacity of 23.58 GiB of which 105.75 MiB is free. Process 1428406 has 7.31 GiB memory in use. Including non-PyTorch memory, this process has 16.15 GiB memory in use. Of the allocated memory 15.49 GiB is allocated by PyTorch, and 265.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

Traceback (most recent call last):
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/base.py", line 748, in _train_model
    results = self.model(inputs, calc_criterion=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/data_parallel.py", line 193, in forward
    outputs = self.parallel_apply(replicas, inputs, module_kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/data_parallel.py", line 212, in parallel_apply
    return parallel_apply(
           ^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py", line 126, in parallel_apply
    output.reraise()
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/_utils.py", line 715, in reraise
    raise exception
torch.OutOfMemoryError: Caught OutOfMemoryError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py", line 96, in _worker
    output = module(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/imputation/timemixerpp/core.py", line 82, in forward
    reconstruction = self.model.imputation(X, None)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/backbone.py", line 333, in imputation
    enc_out_list = self.encoder_model[i](enc_out_list)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 205, in forward
    season, trend = self.dual_axis_attn(out)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 235, in dual_axis_attn
    season = self.col_attn_2d_season(out)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 87, in forward
    out = self.gamma * out + x
          ~~~~~~~~~~~^~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 324.00 MiB. GPU 0 has a total capacity of 23.58 GiB of which 105.75 MiB is free. Process 1428406 has 7.31 GiB memory in use. Including non-PyTorch memory, this process has 16.15 GiB memory in use. Of the allocated memory 15.49 GiB is allocated by PyTorch, and 265.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/23r8105_messou/lab/iPyPOTS/main.py", line 80, in <module>
    main(args)
  File "/home/23r8105_messou/lab/iPyPOTS/main.py", line 59, in main
    mae, mse, rmse, mre = MODEL_PIPELINES[model_name](dataset, args)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pipeline/imputations/timemixerpp.py", line 64, in train_and_evaluate_timemixerpp
    model.fit(train_set=train_set, val_set=val_set)
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/imputation/timemixerpp/model.py", line 270, in fit
    self._train_model(train_dataloader, val_dataloader)
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/base.py", line 825, in _train_model
    raise RuntimeError(
RuntimeError: Training got interrupted. Model was not trained. Please investigate the error printed above.
srun: error: ai-gpgpu14: task 0: Exited with exit code 1
❌ FAIL(1): pems_traffic | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
🔥 RUN: timemixerpp | pems_traffic | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=96, N_FEATURES=228)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 11:04:53 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:04:53 [INFO]: You're using dataset pems_traffic, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/pems_traffic
2025-08-23 11:04:53 [INFO]: Dataset pems_traffic has already been downloaded. Processing directly...
2025-08-23 11:04:53 [INFO]: Dataset pems_traffic has already been cached. Loading from cache directly...
2025-08-23 11:04:53 [INFO]: Loaded successfully!
2025-08-23 11:04:54 [INFO]: months selected as train set are <PeriodArray>
['2015-01', '2015-02', '2015-03', '2015-04', '2015-05', '2015-06', '2015-07',
 '2015-08', '2015-09', '2015-10', '2015-11', '2015-12', '2016-01', '2016-02',
 '2016-03']
Length: 15, dtype: period[M]
2025-08-23 11:04:54 [INFO]: months selected as val set are <PeriodArray>
['2016-04', '2016-05', '2016-06', '2016-07']
Length: 4, dtype: period[M]
2025-08-23 11:04:54 [INFO]: months selected as test set are <PeriodArray>
['2016-08', '2016-09', '2016-10', '2016-11', '2016-12']
Length: 5, dtype: period[M]
2025-08-23 11:04:54 [INFO]: Total sample number: 182
2025-08-23 11:04:54 [INFO]: Training set size: 114 (62.64%)
2025-08-23 11:04:54 [INFO]: Validation set size: 30 (16.48%)
2025-08-23 11:04:54 [INFO]: Test set size: 38 (20.88%)
2025-08-23 11:04:54 [INFO]: Number of steps: 96
2025-08-23 11:04:54 [INFO]: Number of features: 862
2025-08-23 11:04:54 [INFO]: Train set missing rate: 20.00%
2025-08-23 11:04:54 [INFO]: Validating set missing rate: 20.00%
2025-08-23 11:04:54 [INFO]: Test set missing rate: 20.01%
✅ Dataset 'pems_traffic' with missing rate 0.2 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.2
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:04:54 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:04:54 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:04:54 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:04:54 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:04:54 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:04:54 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:04:54 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:04:54 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 862,560
 ├─ Trainable parameters: 857,696
 └─ Trainable ratio: 99.44%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 11:05:02 [INFO]: Epoch 001 - training loss (MAE): 1.7789, validation MSE: 2.6849
2025-08-23 11:05:09 [INFO]: Epoch 002 - training loss (MAE): 1.6746, validation MSE: 2.4655
2025-08-23 11:05:16 [INFO]: Epoch 003 - training loss (MAE): 1.6054, validation MSE: 2.3123
2025-08-23 11:05:23 [INFO]: Epoch 004 - training loss (MAE): 1.5462, validation MSE: 2.1785
2025-08-23 11:05:30 [INFO]: Epoch 005 - training loss (MAE): 1.4769, validation MSE: 2.0407
2025-08-23 11:05:37 [INFO]: Epoch 006 - training loss (MAE): 1.3975, validation MSE: 1.9226
2025-08-23 11:05:44 [INFO]: Epoch 007 - training loss (MAE): 1.3295, validation MSE: 1.8143
2025-08-23 11:05:52 [INFO]: Epoch 008 - training loss (MAE): 1.2751, validation MSE: 1.7750
2025-08-23 11:05:57 [INFO]: Epoch 009 - training loss (MAE): 1.2302, validation MSE: 1.7097
2025-08-23 11:06:05 [INFO]: Epoch 010 - training loss (MAE): 1.2076, validation MSE: 1.6806
2025-08-23 11:06:15 [INFO]: Epoch 011 - training loss (MAE): 1.1903, validation MSE: 1.6510
2025-08-23 11:06:24 [INFO]: Epoch 012 - training loss (MAE): 1.1803, validation MSE: 1.6757
2025-08-23 11:06:33 [INFO]: Epoch 013 - training loss (MAE): 1.1685, validation MSE: 1.6805
2025-08-23 11:06:39 [INFO]: Epoch 014 - training loss (MAE): 1.1622, validation MSE: 1.6543
2025-08-23 11:06:46 [INFO]: Epoch 015 - training loss (MAE): 1.1548, validation MSE: 1.6480
2025-08-23 11:06:46 [INFO]: Finished training. The best model is from epoch#15.
2025-08-23 11:06:46 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.5538| MSE: 1.1042| RMSE: 1.0508| MRE: 0.6878|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: pems_traffic | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): pems_traffic | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): pems_traffic | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | pems_traffic | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=96, N_FEATURES=228)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:06:57 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
2025-08-23 11:06:57 [INFO]: You're using dataset pems_traffic, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/pems_traffic
2025-08-23 11:06:57 [INFO]: Dataset pems_traffic has already been downloaded. Processing directly...
2025-08-23 11:06:57 [INFO]: Dataset pems_traffic has already been cached. Loading from cache directly...
2025-08-23 11:06:58 [INFO]: Loaded successfully!
2025-08-23 11:06:58 [INFO]: months selected as train set are <PeriodArray>
['2015-01', '2015-02', '2015-03', '2015-04', '2015-05', '2015-06', '2015-07',
 '2015-08', '2015-09', '2015-10', '2015-11', '2015-12', '2016-01', '2016-02',
 '2016-03']
Length: 15, dtype: period[M]
2025-08-23 11:06:58 [INFO]: months selected as val set are <PeriodArray>
['2016-04', '2016-05', '2016-06', '2016-07']
Length: 4, dtype: period[M]
2025-08-23 11:06:58 [INFO]: months selected as test set are <PeriodArray>
['2016-08', '2016-09', '2016-10', '2016-11', '2016-12']
Length: 5, dtype: period[M]
2025-08-23 11:06:58 [INFO]: Total sample number: 182
2025-08-23 11:06:58 [INFO]: Training set size: 114 (62.64%)
2025-08-23 11:06:58 [INFO]: Validation set size: 30 (16.48%)
2025-08-23 11:06:58 [INFO]: Test set size: 38 (20.88%)
2025-08-23 11:06:58 [INFO]: Number of steps: 96
2025-08-23 11:06:58 [INFO]: Number of features: 862
2025-08-23 11:06:58 [INFO]: Train set missing rate: 30.01%
2025-08-23 11:06:58 [INFO]: Validating set missing rate: 29.97%
2025-08-23 11:06:58 [INFO]: Test set missing rate: 30.02%
✅ Dataset 'pems_traffic' with missing rate 0.3 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.3
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:06:58 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:06:58 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:06:58 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:06:58 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:06:58 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:06:58 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:06:59 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:06:59 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 641,283
 ├─ Trainable parameters: 636,419
 └─ Trainable ratio: 99.24%
2025-08-23 11:07:02 [ERROR]: ❌ Exception: Caught OutOfMemoryError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py", line 96, in _worker
    output = module(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/imputation/timemixerpp/core.py", line 82, in forward
    reconstruction = self.model.imputation(X, None)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/backbone.py", line 333, in imputation
    enc_out_list = self.encoder_model[i](enc_out_list)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 205, in forward
    season, trend = self.dual_axis_attn(out)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 235, in dual_axis_attn
    season = self.col_attn_2d_season(out)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 87, in forward
    out = self.gamma * out + x
          ~~~~~~~~~~~^~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 324.00 MiB. GPU 0 has a total capacity of 23.58 GiB of which 105.75 MiB is free. Process 1428406 has 7.31 GiB memory in use. Including non-PyTorch memory, this process has 16.15 GiB memory in use. Of the allocated memory 15.49 GiB is allocated by PyTorch, and 265.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

Traceback (most recent call last):
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/base.py", line 748, in _train_model
    results = self.model(inputs, calc_criterion=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/data_parallel.py", line 193, in forward
    outputs = self.parallel_apply(replicas, inputs, module_kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/data_parallel.py", line 212, in parallel_apply
    return parallel_apply(
           ^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py", line 126, in parallel_apply
    output.reraise()
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/_utils.py", line 715, in reraise
    raise exception
torch.OutOfMemoryError: Caught OutOfMemoryError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py", line 96, in _worker
    output = module(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/imputation/timemixerpp/core.py", line 82, in forward
    reconstruction = self.model.imputation(X, None)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/backbone.py", line 333, in imputation
    enc_out_list = self.encoder_model[i](enc_out_list)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 205, in forward
    season, trend = self.dual_axis_attn(out)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 235, in dual_axis_attn
    season = self.col_attn_2d_season(out)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 87, in forward
    out = self.gamma * out + x
          ~~~~~~~~~~~^~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 324.00 MiB. GPU 0 has a total capacity of 23.58 GiB of which 105.75 MiB is free. Process 1428406 has 7.31 GiB memory in use. Including non-PyTorch memory, this process has 16.15 GiB memory in use. Of the allocated memory 15.49 GiB is allocated by PyTorch, and 265.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/23r8105_messou/lab/iPyPOTS/main.py", line 80, in <module>
    main(args)
  File "/home/23r8105_messou/lab/iPyPOTS/main.py", line 59, in main
    mae, mse, rmse, mre = MODEL_PIPELINES[model_name](dataset, args)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pipeline/imputations/timemixerpp.py", line 64, in train_and_evaluate_timemixerpp
    model.fit(train_set=train_set, val_set=val_set)
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/imputation/timemixerpp/model.py", line 270, in fit
    self._train_model(train_dataloader, val_dataloader)
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/base.py", line 825, in _train_model
    raise RuntimeError(
RuntimeError: Training got interrupted. Model was not trained. Please investigate the error printed above.
srun: error: ai-gpgpu14: task 0: Exited with exit code 1
❌ FAIL(1): pems_traffic | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
🔥 RUN: timemixerpp | pems_traffic | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=96, N_FEATURES=228)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 11:07:11 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:07:11 [INFO]: You're using dataset pems_traffic, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/pems_traffic
2025-08-23 11:07:11 [INFO]: Dataset pems_traffic has already been downloaded. Processing directly...
2025-08-23 11:07:11 [INFO]: Dataset pems_traffic has already been cached. Loading from cache directly...
2025-08-23 11:07:12 [INFO]: Loaded successfully!
2025-08-23 11:07:12 [INFO]: months selected as train set are <PeriodArray>
['2015-01', '2015-02', '2015-03', '2015-04', '2015-05', '2015-06', '2015-07',
 '2015-08', '2015-09', '2015-10', '2015-11', '2015-12', '2016-01', '2016-02',
 '2016-03']
Length: 15, dtype: period[M]
2025-08-23 11:07:12 [INFO]: months selected as val set are <PeriodArray>
['2016-04', '2016-05', '2016-06', '2016-07']
Length: 4, dtype: period[M]
2025-08-23 11:07:12 [INFO]: months selected as test set are <PeriodArray>
['2016-08', '2016-09', '2016-10', '2016-11', '2016-12']
Length: 5, dtype: period[M]
2025-08-23 11:07:12 [INFO]: Total sample number: 182
2025-08-23 11:07:12 [INFO]: Training set size: 114 (62.64%)
2025-08-23 11:07:12 [INFO]: Validation set size: 30 (16.48%)
2025-08-23 11:07:12 [INFO]: Test set size: 38 (20.88%)
2025-08-23 11:07:12 [INFO]: Number of steps: 96
2025-08-23 11:07:12 [INFO]: Number of features: 862
2025-08-23 11:07:12 [INFO]: Train set missing rate: 30.01%
2025-08-23 11:07:12 [INFO]: Validating set missing rate: 29.97%
2025-08-23 11:07:12 [INFO]: Test set missing rate: 30.02%
✅ Dataset 'pems_traffic' with missing rate 0.3 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.3
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:07:12 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:07:12 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:07:12 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:07:12 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:07:12 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:07:12 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:07:12 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:07:12 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 862,560
 ├─ Trainable parameters: 857,696
 └─ Trainable ratio: 99.44%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 11:07:21 [INFO]: Epoch 001 - training loss (MAE): 1.7844, validation MSE: 2.6912
2025-08-23 11:07:26 [INFO]: Epoch 002 - training loss (MAE): 1.6801, validation MSE: 2.4712
2025-08-23 11:07:33 [INFO]: Epoch 003 - training loss (MAE): 1.6103, validation MSE: 2.3162
2025-08-23 11:07:37 [INFO]: Epoch 004 - training loss (MAE): 1.5507, validation MSE: 2.1819
2025-08-23 11:07:43 [INFO]: Epoch 005 - training loss (MAE): 1.4817, validation MSE: 2.0432
2025-08-23 11:07:50 [INFO]: Epoch 006 - training loss (MAE): 1.4030, validation MSE: 1.9243
2025-08-23 11:07:58 [INFO]: Epoch 007 - training loss (MAE): 1.3353, validation MSE: 1.8178
2025-08-23 11:08:07 [INFO]: Epoch 008 - training loss (MAE): 1.2823, validation MSE: 1.7799
2025-08-23 11:08:15 [INFO]: Epoch 009 - training loss (MAE): 1.2380, validation MSE: 1.7158
2025-08-23 11:08:21 [INFO]: Epoch 010 - training loss (MAE): 1.2156, validation MSE: 1.6923
2025-08-23 11:08:29 [INFO]: Epoch 011 - training loss (MAE): 1.1987, validation MSE: 1.6574
2025-08-23 11:08:37 [INFO]: Epoch 012 - training loss (MAE): 1.1888, validation MSE: 1.6820
2025-08-23 11:08:47 [INFO]: Epoch 013 - training loss (MAE): 1.1777, validation MSE: 1.6861
2025-08-23 11:08:54 [INFO]: Epoch 014 - training loss (MAE): 1.1723, validation MSE: 1.6580
2025-08-23 11:09:03 [INFO]: Epoch 015 - training loss (MAE): 1.1643, validation MSE: 1.6488
2025-08-23 11:09:03 [INFO]: Finished training. The best model is from epoch#15.
2025-08-23 11:09:03 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.5555| MSE: 1.1064| RMSE: 1.0518| MRE: 0.6894|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: pems_traffic | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): pems_traffic | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): pems_traffic | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | pems_traffic | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=96, N_FEATURES=228)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 11:09:17 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:09:17 [INFO]: You're using dataset pems_traffic, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/pems_traffic
2025-08-23 11:09:17 [INFO]: Dataset pems_traffic has already been downloaded. Processing directly...
2025-08-23 11:09:17 [INFO]: Dataset pems_traffic has already been cached. Loading from cache directly...
2025-08-23 11:09:17 [INFO]: Loaded successfully!
2025-08-23 11:09:17 [INFO]: months selected as train set are <PeriodArray>
['2015-01', '2015-02', '2015-03', '2015-04', '2015-05', '2015-06', '2015-07',
 '2015-08', '2015-09', '2015-10', '2015-11', '2015-12', '2016-01', '2016-02',
 '2016-03']
Length: 15, dtype: period[M]
2025-08-23 11:09:17 [INFO]: months selected as val set are <PeriodArray>
['2016-04', '2016-05', '2016-06', '2016-07']
Length: 4, dtype: period[M]
2025-08-23 11:09:17 [INFO]: months selected as test set are <PeriodArray>
['2016-08', '2016-09', '2016-10', '2016-11', '2016-12']
Length: 5, dtype: period[M]
2025-08-23 11:09:18 [INFO]: Total sample number: 182
2025-08-23 11:09:18 [INFO]: Training set size: 114 (62.64%)
2025-08-23 11:09:18 [INFO]: Validation set size: 30 (16.48%)
2025-08-23 11:09:18 [INFO]: Test set size: 38 (20.88%)
2025-08-23 11:09:18 [INFO]: Number of steps: 96
2025-08-23 11:09:18 [INFO]: Number of features: 862
2025-08-23 11:09:18 [INFO]: Train set missing rate: 40.01%
2025-08-23 11:09:18 [INFO]: Validating set missing rate: 39.94%
2025-08-23 11:09:18 [INFO]: Test set missing rate: 40.04%
✅ Dataset 'pems_traffic' with missing rate 0.4 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.4
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:09:18 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:09:18 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:09:18 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:09:18 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:09:18 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:09:18 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:09:18 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:09:18 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 641,283
 ├─ Trainable parameters: 636,419
 └─ Trainable ratio: 99.24%
2025-08-23 11:09:21 [ERROR]: ❌ Exception: Caught OutOfMemoryError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py", line 96, in _worker
    output = module(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/imputation/timemixerpp/core.py", line 82, in forward
    reconstruction = self.model.imputation(X, None)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/backbone.py", line 333, in imputation
    enc_out_list = self.encoder_model[i](enc_out_list)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 205, in forward
    season, trend = self.dual_axis_attn(out)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 235, in dual_axis_attn
    season = self.col_attn_2d_season(out)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 87, in forward
    out = self.gamma * out + x
          ~~~~~~~~~~~^~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 324.00 MiB. GPU 0 has a total capacity of 23.58 GiB of which 105.75 MiB is free. Process 1428406 has 7.31 GiB memory in use. Including non-PyTorch memory, this process has 16.15 GiB memory in use. Of the allocated memory 15.49 GiB is allocated by PyTorch, and 265.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

Traceback (most recent call last):
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/base.py", line 748, in _train_model
    results = self.model(inputs, calc_criterion=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/data_parallel.py", line 193, in forward
    outputs = self.parallel_apply(replicas, inputs, module_kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/data_parallel.py", line 212, in parallel_apply
    return parallel_apply(
           ^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py", line 126, in parallel_apply
    output.reraise()
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/_utils.py", line 715, in reraise
    raise exception
torch.OutOfMemoryError: Caught OutOfMemoryError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py", line 96, in _worker
    output = module(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/imputation/timemixerpp/core.py", line 82, in forward
    reconstruction = self.model.imputation(X, None)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/backbone.py", line 333, in imputation
    enc_out_list = self.encoder_model[i](enc_out_list)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 205, in forward
    season, trend = self.dual_axis_attn(out)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 235, in dual_axis_attn
    season = self.col_attn_2d_season(out)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 87, in forward
    out = self.gamma * out + x
          ~~~~~~~~~~~^~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 324.00 MiB. GPU 0 has a total capacity of 23.58 GiB of which 105.75 MiB is free. Process 1428406 has 7.31 GiB memory in use. Including non-PyTorch memory, this process has 16.15 GiB memory in use. Of the allocated memory 15.49 GiB is allocated by PyTorch, and 265.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/23r8105_messou/lab/iPyPOTS/main.py", line 80, in <module>
    main(args)
  File "/home/23r8105_messou/lab/iPyPOTS/main.py", line 59, in main
    mae, mse, rmse, mre = MODEL_PIPELINES[model_name](dataset, args)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pipeline/imputations/timemixerpp.py", line 64, in train_and_evaluate_timemixerpp
    model.fit(train_set=train_set, val_set=val_set)
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/imputation/timemixerpp/model.py", line 270, in fit
    self._train_model(train_dataloader, val_dataloader)
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/base.py", line 825, in _train_model
    raise RuntimeError(
RuntimeError: Training got interrupted. Model was not trained. Please investigate the error printed above.
srun: error: ai-gpgpu14: task 0: Exited with exit code 1
❌ FAIL(1): pems_traffic | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
🔥 RUN: timemixerpp | pems_traffic | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=96, N_FEATURES=228)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:09:31 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
2025-08-23 11:09:31 [INFO]: You're using dataset pems_traffic, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/pems_traffic
2025-08-23 11:09:31 [INFO]: Dataset pems_traffic has already been downloaded. Processing directly...
2025-08-23 11:09:31 [INFO]: Dataset pems_traffic has already been cached. Loading from cache directly...
2025-08-23 11:09:31 [INFO]: Loaded successfully!
2025-08-23 11:09:31 [INFO]: months selected as train set are <PeriodArray>
['2015-01', '2015-02', '2015-03', '2015-04', '2015-05', '2015-06', '2015-07',
 '2015-08', '2015-09', '2015-10', '2015-11', '2015-12', '2016-01', '2016-02',
 '2016-03']
Length: 15, dtype: period[M]
2025-08-23 11:09:31 [INFO]: months selected as val set are <PeriodArray>
['2016-04', '2016-05', '2016-06', '2016-07']
Length: 4, dtype: period[M]
2025-08-23 11:09:31 [INFO]: months selected as test set are <PeriodArray>
['2016-08', '2016-09', '2016-10', '2016-11', '2016-12']
Length: 5, dtype: period[M]
2025-08-23 11:09:31 [INFO]: Total sample number: 182
2025-08-23 11:09:31 [INFO]: Training set size: 114 (62.64%)
2025-08-23 11:09:31 [INFO]: Validation set size: 30 (16.48%)
2025-08-23 11:09:31 [INFO]: Test set size: 38 (20.88%)
2025-08-23 11:09:31 [INFO]: Number of steps: 96
2025-08-23 11:09:31 [INFO]: Number of features: 862
2025-08-23 11:09:31 [INFO]: Train set missing rate: 40.01%
2025-08-23 11:09:31 [INFO]: Validating set missing rate: 39.94%
2025-08-23 11:09:31 [INFO]: Test set missing rate: 40.04%
✅ Dataset 'pems_traffic' with missing rate 0.4 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.4
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:09:31 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:09:31 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:09:32 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:09:32 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:09:32 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:09:32 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:09:32 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:09:32 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 862,560
 ├─ Trainable parameters: 857,696
 └─ Trainable ratio: 99.44%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 11:09:41 [INFO]: Epoch 001 - training loss (MAE): 1.7913, validation MSE: 2.6874
2025-08-23 11:09:46 [INFO]: Epoch 002 - training loss (MAE): 1.6873, validation MSE: 2.4657
2025-08-23 11:09:53 [INFO]: Epoch 003 - training loss (MAE): 1.6168, validation MSE: 2.3075
2025-08-23 11:10:01 [INFO]: Epoch 004 - training loss (MAE): 1.5569, validation MSE: 2.1727
2025-08-23 11:10:09 [INFO]: Epoch 005 - training loss (MAE): 1.4880, validation MSE: 2.0353
2025-08-23 11:10:17 [INFO]: Epoch 006 - training loss (MAE): 1.4097, validation MSE: 1.9175
2025-08-23 11:10:22 [INFO]: Epoch 007 - training loss (MAE): 1.3428, validation MSE: 1.8158
2025-08-23 11:10:28 [INFO]: Epoch 008 - training loss (MAE): 1.2909, validation MSE: 1.7675
2025-08-23 11:10:34 [INFO]: Epoch 009 - training loss (MAE): 1.2470, validation MSE: 1.7063
2025-08-23 11:10:41 [INFO]: Epoch 010 - training loss (MAE): 1.2251, validation MSE: 1.6822
2025-08-23 11:10:47 [INFO]: Epoch 011 - training loss (MAE): 1.2088, validation MSE: 1.6574
2025-08-23 11:10:55 [INFO]: Epoch 012 - training loss (MAE): 1.1995, validation MSE: 1.6747
2025-08-23 11:11:01 [INFO]: Epoch 013 - training loss (MAE): 1.1887, validation MSE: 1.6694
2025-08-23 11:11:08 [INFO]: Epoch 014 - training loss (MAE): 1.1830, validation MSE: 1.6508
2025-08-23 11:11:14 [INFO]: Epoch 015 - training loss (MAE): 1.1755, validation MSE: 1.6410
2025-08-23 11:11:14 [INFO]: Finished training. The best model is from epoch#15.
2025-08-23 11:11:14 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.5568| MSE: 1.1044| RMSE: 1.0509| MRE: 0.6911|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: pems_traffic | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): pems_traffic | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): pems_traffic | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | pems_traffic | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=96, N_FEATURES=228)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:11:25 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
2025-08-23 11:11:25 [INFO]: You're using dataset pems_traffic, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/pems_traffic
2025-08-23 11:11:25 [INFO]: Dataset pems_traffic has already been downloaded. Processing directly...
2025-08-23 11:11:25 [INFO]: Dataset pems_traffic has already been cached. Loading from cache directly...
2025-08-23 11:11:25 [INFO]: Loaded successfully!
2025-08-23 11:11:25 [INFO]: months selected as train set are <PeriodArray>
['2015-01', '2015-02', '2015-03', '2015-04', '2015-05', '2015-06', '2015-07',
 '2015-08', '2015-09', '2015-10', '2015-11', '2015-12', '2016-01', '2016-02',
 '2016-03']
Length: 15, dtype: period[M]
2025-08-23 11:11:25 [INFO]: months selected as val set are <PeriodArray>
['2016-04', '2016-05', '2016-06', '2016-07']
Length: 4, dtype: period[M]
2025-08-23 11:11:25 [INFO]: months selected as test set are <PeriodArray>
['2016-08', '2016-09', '2016-10', '2016-11', '2016-12']
Length: 5, dtype: period[M]
2025-08-23 11:11:25 [INFO]: Total sample number: 182
2025-08-23 11:11:25 [INFO]: Training set size: 114 (62.64%)
2025-08-23 11:11:25 [INFO]: Validation set size: 30 (16.48%)
2025-08-23 11:11:25 [INFO]: Test set size: 38 (20.88%)
2025-08-23 11:11:25 [INFO]: Number of steps: 96
2025-08-23 11:11:25 [INFO]: Number of features: 862
2025-08-23 11:11:25 [INFO]: Train set missing rate: 50.01%
2025-08-23 11:11:25 [INFO]: Validating set missing rate: 49.93%
2025-08-23 11:11:25 [INFO]: Test set missing rate: 50.04%
✅ Dataset 'pems_traffic' with missing rate 0.5 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.5
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:11:25 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:11:25 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:11:26 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:11:26 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:11:26 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:11:26 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:11:26 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:11:26 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 641,283
 ├─ Trainable parameters: 636,419
 └─ Trainable ratio: 99.24%
2025-08-23 11:11:29 [ERROR]: ❌ Exception: Caught OutOfMemoryError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py", line 96, in _worker
    output = module(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/imputation/timemixerpp/core.py", line 82, in forward
    reconstruction = self.model.imputation(X, None)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/backbone.py", line 333, in imputation
    enc_out_list = self.encoder_model[i](enc_out_list)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 205, in forward
    season, trend = self.dual_axis_attn(out)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 235, in dual_axis_attn
    season = self.col_attn_2d_season(out)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 87, in forward
    out = self.gamma * out + x
          ~~~~~~~~~~~^~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 324.00 MiB. GPU 0 has a total capacity of 23.58 GiB of which 105.75 MiB is free. Process 1428406 has 7.31 GiB memory in use. Including non-PyTorch memory, this process has 16.15 GiB memory in use. Of the allocated memory 15.49 GiB is allocated by PyTorch, and 265.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

Traceback (most recent call last):
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/base.py", line 748, in _train_model
    results = self.model(inputs, calc_criterion=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/data_parallel.py", line 193, in forward
    outputs = self.parallel_apply(replicas, inputs, module_kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/data_parallel.py", line 212, in parallel_apply
    return parallel_apply(
           ^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py", line 126, in parallel_apply
    output.reraise()
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/_utils.py", line 715, in reraise
    raise exception
torch.OutOfMemoryError: Caught OutOfMemoryError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/parallel_apply.py", line 96, in _worker
    output = module(*input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/imputation/timemixerpp/core.py", line 82, in forward
    reconstruction = self.model.imputation(X, None)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/backbone.py", line 333, in imputation
    enc_out_list = self.encoder_model[i](enc_out_list)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 205, in forward
    season, trend = self.dual_axis_attn(out)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 235, in dual_axis_attn
    season = self.col_attn_2d_season(out)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/nn/modules/timemixerpp/layers.py", line 87, in forward
    out = self.gamma * out + x
          ~~~~~~~~~~~^~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 324.00 MiB. GPU 0 has a total capacity of 23.58 GiB of which 105.75 MiB is free. Process 1428406 has 7.31 GiB memory in use. Including non-PyTorch memory, this process has 16.15 GiB memory in use. Of the allocated memory 15.49 GiB is allocated by PyTorch, and 265.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/23r8105_messou/lab/iPyPOTS/main.py", line 80, in <module>
    main(args)
  File "/home/23r8105_messou/lab/iPyPOTS/main.py", line 59, in main
    mae, mse, rmse, mre = MODEL_PIPELINES[model_name](dataset, args)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/23r8105_messou/lab/iPyPOTS/pipeline/imputations/timemixerpp.py", line 64, in train_and_evaluate_timemixerpp
    model.fit(train_set=train_set, val_set=val_set)
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/imputation/timemixerpp/model.py", line 270, in fit
    self._train_model(train_dataloader, val_dataloader)
  File "/home/23r8105_messou/lab/iPyPOTS/pypots/base.py", line 825, in _train_model
    raise RuntimeError(
RuntimeError: Training got interrupted. Model was not trained. Please investigate the error printed above.
srun: error: ai-gpgpu14: task 0: Exited with exit code 1
❌ FAIL(1): pems_traffic | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
🔥 RUN: timemixerpp | pems_traffic | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=96, N_FEATURES=228)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 11:11:41 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:11:41 [INFO]: You're using dataset pems_traffic, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/pems_traffic
2025-08-23 11:11:41 [INFO]: Dataset pems_traffic has already been downloaded. Processing directly...
2025-08-23 11:11:41 [INFO]: Dataset pems_traffic has already been cached. Loading from cache directly...
2025-08-23 11:11:41 [INFO]: Loaded successfully!
2025-08-23 11:11:41 [INFO]: months selected as train set are <PeriodArray>
['2015-01', '2015-02', '2015-03', '2015-04', '2015-05', '2015-06', '2015-07',
 '2015-08', '2015-09', '2015-10', '2015-11', '2015-12', '2016-01', '2016-02',
 '2016-03']
Length: 15, dtype: period[M]
2025-08-23 11:11:41 [INFO]: months selected as val set are <PeriodArray>
['2016-04', '2016-05', '2016-06', '2016-07']
Length: 4, dtype: period[M]
2025-08-23 11:11:41 [INFO]: months selected as test set are <PeriodArray>
['2016-08', '2016-09', '2016-10', '2016-11', '2016-12']
Length: 5, dtype: period[M]
2025-08-23 11:11:41 [INFO]: Total sample number: 182
2025-08-23 11:11:41 [INFO]: Training set size: 114 (62.64%)
2025-08-23 11:11:41 [INFO]: Validation set size: 30 (16.48%)
2025-08-23 11:11:41 [INFO]: Test set size: 38 (20.88%)
2025-08-23 11:11:41 [INFO]: Number of steps: 96
2025-08-23 11:11:41 [INFO]: Number of features: 862
2025-08-23 11:11:41 [INFO]: Train set missing rate: 50.01%
2025-08-23 11:11:41 [INFO]: Validating set missing rate: 49.93%
2025-08-23 11:11:41 [INFO]: Test set missing rate: 50.04%
✅ Dataset 'pems_traffic' with missing rate 0.5 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.5
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:11:41 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:11:41 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:11:42 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:11:42 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:11:42 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:11:42 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:11:42 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:11:42 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 862,560
 ├─ Trainable parameters: 857,696
 └─ Trainable ratio: 99.44%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 11:11:50 [INFO]: Epoch 001 - training loss (MAE): 1.8004, validation MSE: 2.7061
2025-08-23 11:11:59 [INFO]: Epoch 002 - training loss (MAE): 1.6977, validation MSE: 2.4762
2025-08-23 11:12:06 [INFO]: Epoch 003 - training loss (MAE): 1.6271, validation MSE: 2.3156
2025-08-23 11:12:11 [INFO]: Epoch 004 - training loss (MAE): 1.5679, validation MSE: 2.1804
2025-08-23 11:12:18 [INFO]: Epoch 005 - training loss (MAE): 1.5005, validation MSE: 2.0417
2025-08-23 11:12:26 [INFO]: Epoch 006 - training loss (MAE): 1.4239, validation MSE: 1.9208
2025-08-23 11:12:35 [INFO]: Epoch 007 - training loss (MAE): 1.3579, validation MSE: 1.8176
2025-08-23 11:12:42 [INFO]: Epoch 008 - training loss (MAE): 1.3058, validation MSE: 1.7699
2025-08-23 11:12:49 [INFO]: Epoch 009 - training loss (MAE): 1.2630, validation MSE: 1.7111
2025-08-23 11:12:55 [INFO]: Epoch 010 - training loss (MAE): 1.2420, validation MSE: 1.6851
2025-08-23 11:13:03 [INFO]: Epoch 011 - training loss (MAE): 1.2250, validation MSE: 1.6522
2025-08-23 11:13:11 [INFO]: Epoch 012 - training loss (MAE): 1.2159, validation MSE: 1.6764
2025-08-23 11:13:22 [INFO]: Epoch 013 - training loss (MAE): 1.2057, validation MSE: 1.6754
2025-08-23 11:13:29 [INFO]: Epoch 014 - training loss (MAE): 1.2006, validation MSE: 1.6528
2025-08-23 11:13:39 [INFO]: Epoch 015 - training loss (MAE): 1.1934, validation MSE: 1.6395
2025-08-23 11:13:39 [INFO]: Finished training. The best model is from epoch#15.
2025-08-23 11:13:39 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.5589| MSE: 1.0957| RMSE: 1.0468| MRE: 0.6941|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/pems_traffic/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: pems_traffic | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): pems_traffic | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): pems_traffic | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | solar_alabama | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=96, N_FEATURES=137)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 11:13:50 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:13:50 [INFO]: You're using dataset solar_alabama, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/solar_alabama
2025-08-23 11:13:50 [INFO]: Dataset solar_alabama has already been downloaded. Processing directly...
2025-08-23 11:13:50 [INFO]: Dataset solar_alabama has already been cached. Loading from cache directly...
2025-08-23 11:13:50 [INFO]: Loaded successfully!
2025-08-23 11:13:50 [INFO]: months selected as train set are <PeriodArray>
['2006-01', '2006-02', '2006-03', '2006-04', '2006-05', '2006-06']
Length: 6, dtype: period[M]
2025-08-23 11:13:50 [INFO]: months selected as val set are <PeriodArray>
['2006-07', '2006-08', '2006-09']
Length: 3, dtype: period[M]
2025-08-23 11:13:50 [INFO]: months selected as test set are <PeriodArray>
['2006-10', '2006-11', '2006-12']
Length: 3, dtype: period[M]
2025-08-23 11:13:50 [INFO]: Total sample number: 547
2025-08-23 11:13:50 [INFO]: Training set size: 271 (49.54%)
2025-08-23 11:13:50 [INFO]: Validation set size: 138 (25.23%)
2025-08-23 11:13:50 [INFO]: Test set size: 138 (25.23%)
2025-08-23 11:13:50 [INFO]: Number of steps: 96
2025-08-23 11:13:50 [INFO]: Number of features: 137
2025-08-23 11:13:50 [INFO]: Train set missing rate: 9.98%
2025-08-23 11:13:50 [INFO]: Validating set missing rate: 9.94%
2025-08-23 11:13:50 [INFO]: Test set missing rate: 9.99%
✅ Dataset 'solar_alabama' with missing rate 0.1 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.1
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:13:50 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:13:50 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:13:51 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:13:51 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:13:51 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:13:51 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:13:51 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:13:51 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 641,283
 ├─ Trainable parameters: 636,419
 └─ Trainable ratio: 99.24%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 11:14:02 [INFO]: Epoch 001 - training loss (MAE): 1.2762, validation MSE: 0.7066
2025-08-23 11:14:10 [INFO]: Epoch 002 - training loss (MAE): 0.9441, validation MSE: 0.6870
2025-08-23 11:14:18 [INFO]: Epoch 003 - training loss (MAE): 0.8374, validation MSE: 0.8381
2025-08-23 11:14:26 [INFO]: Epoch 004 - training loss (MAE): 0.7584, validation MSE: 1.0661
2025-08-23 11:14:35 [INFO]: Epoch 005 - training loss (MAE): 0.7110, validation MSE: 1.2267
2025-08-23 11:14:44 [INFO]: Epoch 006 - training loss (MAE): 0.6713, validation MSE: 1.0800
2025-08-23 11:14:53 [INFO]: Epoch 007 - training loss (MAE): 0.6382, validation MSE: 1.1007
2025-08-23 11:14:53 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 11:14:53 [INFO]: Finished training. The best model is from epoch#2.
2025-08-23 11:14:53 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.4526| MSE: 0.3482| RMSE: 0.5901| MRE: 0.5839|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: solar_alabama | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): solar_alabama | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): solar_alabama | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): solar_alabama | mr0.1_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | solar_alabama | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=96, N_FEATURES=137)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 11:15:07 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:15:07 [INFO]: You're using dataset solar_alabama, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/solar_alabama
2025-08-23 11:15:07 [INFO]: Dataset solar_alabama has already been downloaded. Processing directly...
2025-08-23 11:15:07 [INFO]: Dataset solar_alabama has already been cached. Loading from cache directly...
2025-08-23 11:15:07 [INFO]: Loaded successfully!
2025-08-23 11:15:07 [INFO]: months selected as train set are <PeriodArray>
['2006-01', '2006-02', '2006-03', '2006-04', '2006-05', '2006-06']
Length: 6, dtype: period[M]
2025-08-23 11:15:07 [INFO]: months selected as val set are <PeriodArray>
['2006-07', '2006-08', '2006-09']
Length: 3, dtype: period[M]
2025-08-23 11:15:07 [INFO]: months selected as test set are <PeriodArray>
['2006-10', '2006-11', '2006-12']
Length: 3, dtype: period[M]
2025-08-23 11:15:08 [INFO]: Total sample number: 547
2025-08-23 11:15:08 [INFO]: Training set size: 271 (49.54%)
2025-08-23 11:15:08 [INFO]: Validation set size: 138 (25.23%)
2025-08-23 11:15:08 [INFO]: Test set size: 138 (25.23%)
2025-08-23 11:15:08 [INFO]: Number of steps: 96
2025-08-23 11:15:08 [INFO]: Number of features: 137
2025-08-23 11:15:08 [INFO]: Train set missing rate: 20.00%
2025-08-23 11:15:08 [INFO]: Validating set missing rate: 19.95%
2025-08-23 11:15:08 [INFO]: Test set missing rate: 20.01%
✅ Dataset 'solar_alabama' with missing rate 0.2 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.2
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:15:08 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:15:08 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:15:08 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:15:08 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:15:08 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:15:08 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:15:08 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:15:08 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 641,283
 ├─ Trainable parameters: 636,419
 └─ Trainable ratio: 99.24%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 11:15:19 [INFO]: Epoch 001 - training loss (MAE): 1.3116, validation MSE: 1.0164
2025-08-23 11:15:27 [INFO]: Epoch 002 - training loss (MAE): 0.9611, validation MSE: 0.8979
2025-08-23 11:15:35 [INFO]: Epoch 003 - training loss (MAE): 0.8556, validation MSE: 1.1455
2025-08-23 11:15:43 [INFO]: Epoch 004 - training loss (MAE): 0.7746, validation MSE: 1.2773
2025-08-23 11:15:52 [INFO]: Epoch 005 - training loss (MAE): 0.7260, validation MSE: 1.3495
2025-08-23 11:16:00 [INFO]: Epoch 006 - training loss (MAE): 0.6820, validation MSE: 1.1995
2025-08-23 11:16:09 [INFO]: Epoch 007 - training loss (MAE): 0.6482, validation MSE: 1.2332
2025-08-23 11:16:09 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 11:16:09 [INFO]: Finished training. The best model is from epoch#2.
2025-08-23 11:16:09 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.4659| MSE: 0.4206| RMSE: 0.6485| MRE: 0.6016|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: solar_alabama | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): solar_alabama | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): solar_alabama | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): solar_alabama | mr0.2_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | solar_alabama | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=96, N_FEATURES=137)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:16:22 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
2025-08-23 11:16:22 [INFO]: You're using dataset solar_alabama, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/solar_alabama
2025-08-23 11:16:22 [INFO]: Dataset solar_alabama has already been downloaded. Processing directly...
2025-08-23 11:16:22 [INFO]: Dataset solar_alabama has already been cached. Loading from cache directly...
2025-08-23 11:16:22 [INFO]: Loaded successfully!
2025-08-23 11:16:22 [INFO]: months selected as train set are <PeriodArray>
['2006-01', '2006-02', '2006-03', '2006-04', '2006-05', '2006-06']
Length: 6, dtype: period[M]
2025-08-23 11:16:22 [INFO]: months selected as val set are <PeriodArray>
['2006-07', '2006-08', '2006-09']
Length: 3, dtype: period[M]
2025-08-23 11:16:22 [INFO]: months selected as test set are <PeriodArray>
['2006-10', '2006-11', '2006-12']
Length: 3, dtype: period[M]
2025-08-23 11:16:22 [INFO]: Total sample number: 547
2025-08-23 11:16:22 [INFO]: Training set size: 271 (49.54%)
2025-08-23 11:16:22 [INFO]: Validation set size: 138 (25.23%)
2025-08-23 11:16:22 [INFO]: Test set size: 138 (25.23%)
2025-08-23 11:16:22 [INFO]: Number of steps: 96
2025-08-23 11:16:22 [INFO]: Number of features: 137
2025-08-23 11:16:22 [INFO]: Train set missing rate: 30.02%
2025-08-23 11:16:22 [INFO]: Validating set missing rate: 29.94%
2025-08-23 11:16:22 [INFO]: Test set missing rate: 30.02%
✅ Dataset 'solar_alabama' with missing rate 0.3 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.3
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:16:22 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:16:22 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:16:22 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:16:22 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:16:22 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:16:22 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:16:22 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:16:22 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 641,283
 ├─ Trainable parameters: 636,419
 └─ Trainable ratio: 99.24%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 11:16:33 [INFO]: Epoch 001 - training loss (MAE): 1.3454, validation MSE: 1.4676
2025-08-23 11:16:42 [INFO]: Epoch 002 - training loss (MAE): 0.9812, validation MSE: 1.1853
2025-08-23 11:16:50 [INFO]: Epoch 003 - training loss (MAE): 0.8764, validation MSE: 1.5438
2025-08-23 11:16:59 [INFO]: Epoch 004 - training loss (MAE): 0.7948, validation MSE: 1.5155
2025-08-23 11:17:07 [INFO]: Epoch 005 - training loss (MAE): 0.7415, validation MSE: 1.4900
2025-08-23 11:17:16 [INFO]: Epoch 006 - training loss (MAE): 0.6955, validation MSE: 1.3330
2025-08-23 11:17:25 [INFO]: Epoch 007 - training loss (MAE): 0.6615, validation MSE: 1.2563
2025-08-23 11:17:25 [INFO]: Exceeded the training patience. Terminating the training procedure...
2025-08-23 11:17:25 [INFO]: Finished training. The best model is from epoch#2.
2025-08-23 11:17:26 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.4925| MSE: 0.5187| RMSE: 0.7202| MRE: 0.6359|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: solar_alabama | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): solar_alabama | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): solar_alabama | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): solar_alabama | mr0.3_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | solar_alabama | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=96, N_FEATURES=137)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-23 11:17:40 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: timemixerpp
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:17:40 [INFO]: You're using dataset solar_alabama, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/solar_alabama
2025-08-23 11:17:40 [INFO]: Dataset solar_alabama has already been downloaded. Processing directly...
2025-08-23 11:17:40 [INFO]: Dataset solar_alabama has already been cached. Loading from cache directly...
2025-08-23 11:17:40 [INFO]: Loaded successfully!
2025-08-23 11:17:40 [INFO]: months selected as train set are <PeriodArray>
['2006-01', '2006-02', '2006-03', '2006-04', '2006-05', '2006-06']
Length: 6, dtype: period[M]
2025-08-23 11:17:40 [INFO]: months selected as val set are <PeriodArray>
['2006-07', '2006-08', '2006-09']
Length: 3, dtype: period[M]
2025-08-23 11:17:40 [INFO]: months selected as test set are <PeriodArray>
['2006-10', '2006-11', '2006-12']
Length: 3, dtype: period[M]
2025-08-23 11:17:41 [INFO]: Total sample number: 547
2025-08-23 11:17:41 [INFO]: Training set size: 271 (49.54%)
2025-08-23 11:17:41 [INFO]: Validation set size: 138 (25.23%)
2025-08-23 11:17:41 [INFO]: Test set size: 138 (25.23%)
2025-08-23 11:17:41 [INFO]: Number of steps: 96
2025-08-23 11:17:41 [INFO]: Number of features: 137
2025-08-23 11:17:41 [INFO]: Train set missing rate: 40.00%
2025-08-23 11:17:41 [INFO]: Validating set missing rate: 39.97%
2025-08-23 11:17:41 [INFO]: Test set missing rate: 40.00%
✅ Dataset 'solar_alabama' with missing rate 0.4 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.4
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:17:41 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:17:41 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:17:41 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:17:41 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:17:41 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:17:41 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:17:41 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:17:41 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 641,283
 ├─ Trainable parameters: 636,419
 └─ Trainable ratio: 99.24%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 11:17:52 [INFO]: Epoch 001 - training loss (MAE): 1.3783, validation MSE: 2.1216
2025-08-23 11:18:00 [INFO]: Epoch 002 - training loss (MAE): 1.0056, validation MSE: 1.6049
2025-08-23 11:18:08 [INFO]: Epoch 003 - training loss (MAE): 0.8980, validation MSE: 2.0203
2025-08-23 11:18:16 [INFO]: Epoch 004 - training loss (MAE): 0.8138, validation MSE: 1.7623
2025-08-23 11:18:25 [INFO]: Epoch 005 - training loss (MAE): 0.7570, validation MSE: 1.8186
2025-08-23 11:18:33 [INFO]: Epoch 006 - training loss (MAE): 0.7105, validation MSE: 1.7713
2025-08-23 11:18:42 [INFO]: Epoch 007 - training loss (MAE): 0.6749, validation MSE: 1.4344
2025-08-23 11:18:50 [INFO]: Epoch 008 - training loss (MAE): 0.6339, validation MSE: 1.8643
2025-08-23 11:18:59 [INFO]: Epoch 009 - training loss (MAE): 0.6043, validation MSE: 1.3725
2025-08-23 11:19:07 [INFO]: Epoch 010 - training loss (MAE): 0.5824, validation MSE: 1.6087
2025-08-23 11:19:16 [INFO]: Epoch 011 - training loss (MAE): 0.5657, validation MSE: 1.2489
2025-08-23 11:19:25 [INFO]: Epoch 012 - training loss (MAE): 0.5523, validation MSE: 1.4181
2025-08-23 11:19:33 [INFO]: Epoch 013 - training loss (MAE): 0.5427, validation MSE: 1.3194
2025-08-23 11:19:42 [INFO]: Epoch 014 - training loss (MAE): 0.5440, validation MSE: 1.2071
2025-08-23 11:19:51 [INFO]: Epoch 015 - training loss (MAE): 0.5398, validation MSE: 1.1728
2025-08-23 11:19:51 [INFO]: Finished training. The best model is from epoch#15.
2025-08-23 11:19:51 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.5437| MSE: 0.4763| RMSE: 0.6901| MRE: 0.7022|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: solar_alabama | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): solar_alabama | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): solar_alabama | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): solar_alabama | mr0.4_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
🔥 RUN: timemixerpp | solar_alabama | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1 (DEVICE=cuda:0 cuda:6, N_STEPS=96, N_FEATURES=137)
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
🚀 Running imputation pipeline for model: timemixerpp
2025-08-23 11:20:06 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-23 11:20:06 [INFO]: You're using dataset solar_alabama, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/solar_alabama
2025-08-23 11:20:06 [INFO]: Dataset solar_alabama has already been downloaded. Processing directly...
2025-08-23 11:20:06 [INFO]: Dataset solar_alabama has already been cached. Loading from cache directly...
2025-08-23 11:20:06 [INFO]: Loaded successfully!
2025-08-23 11:20:06 [INFO]: months selected as train set are <PeriodArray>
['2006-01', '2006-02', '2006-03', '2006-04', '2006-05', '2006-06']
Length: 6, dtype: period[M]
2025-08-23 11:20:06 [INFO]: months selected as val set are <PeriodArray>
['2006-07', '2006-08', '2006-09']
Length: 3, dtype: period[M]
2025-08-23 11:20:06 [INFO]: months selected as test set are <PeriodArray>
['2006-10', '2006-11', '2006-12']
Length: 3, dtype: period[M]
2025-08-23 11:20:06 [INFO]: Total sample number: 547
2025-08-23 11:20:06 [INFO]: Training set size: 271 (49.54%)
2025-08-23 11:20:06 [INFO]: Validation set size: 138 (25.23%)
2025-08-23 11:20:06 [INFO]: Test set size: 138 (25.23%)
2025-08-23 11:20:06 [INFO]: Number of steps: 96
2025-08-23 11:20:06 [INFO]: Number of features: 137
2025-08-23 11:20:06 [INFO]: Train set missing rate: 49.99%
2025-08-23 11:20:06 [INFO]: Validating set missing rate: 50.03%
2025-08-23 11:20:06 [INFO]: Test set missing rate: 50.02%
✅ Dataset 'solar_alabama' with missing rate 0.5 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.5
🚀 Starting TimeMixer++ training pipeline...
2025-08-23 11:20:06 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:0', 'cuda:6']
2025-08-23 11:20:06 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: [device(type='cuda', index=0), device(type='cuda', index=6)]
2025-08-23 11:20:06 [INFO]: Model files will be saved to output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3
2025-08-23 11:20:06 [INFO]: Tensorboard file will be saved to output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/tensorboard
2025-08-23 11:20:06 [INFO]: Using customized MAE as the training loss function.
2025-08-23 11:20:06 [INFO]: Using customized MSE as the validation metric function.
2025-08-23 11:20:06 [INFO]: Model placed on CUDA devices [0, 6]
2025-08-23 11:20:06 [INFO]: TimeMixerPP initialized with the given hyperparameters.
 ├─ Total parameters: 641,283
 ├─ Trainable parameters: 636,419
 └─ Trainable ratio: 99.24%
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
2025-08-23 11:20:17 [INFO]: Epoch 001 - training loss (MAE): 1.4094, validation MSE: 2.9459
2025-08-23 11:20:25 [INFO]: Epoch 002 - training loss (MAE): 1.0340, validation MSE: 2.1668
2025-08-23 11:20:33 [INFO]: Epoch 003 - training loss (MAE): 0.9263, validation MSE: 2.4343
2025-08-23 11:20:42 [INFO]: Epoch 004 - training loss (MAE): 0.8443, validation MSE: 2.0598
2025-08-23 11:20:51 [INFO]: Epoch 005 - training loss (MAE): 0.7881, validation MSE: 2.1718
2025-08-23 11:21:00 [INFO]: Epoch 006 - training loss (MAE): 0.7392, validation MSE: 2.1370
2025-08-23 11:21:09 [INFO]: Epoch 007 - training loss (MAE): 0.6946, validation MSE: 1.7386
2025-08-23 11:21:18 [INFO]: Epoch 008 - training loss (MAE): 0.6480, validation MSE: 1.9463
2025-08-23 11:21:27 [INFO]: Epoch 009 - training loss (MAE): 0.6244, validation MSE: 1.4819
2025-08-23 11:21:36 [INFO]: Epoch 010 - training loss (MAE): 0.6001, validation MSE: 1.6888
2025-08-23 11:21:44 [INFO]: Epoch 011 - training loss (MAE): 0.5863, validation MSE: 1.1964
2025-08-23 11:21:53 [INFO]: Epoch 012 - training loss (MAE): 0.5720, validation MSE: 1.4594
2025-08-23 11:22:03 [INFO]: Epoch 013 - training loss (MAE): 0.5598, validation MSE: 1.3746
2025-08-23 11:22:12 [INFO]: Epoch 014 - training loss (MAE): 0.5482, validation MSE: 1.3666
2025-08-23 11:22:21 [INFO]: Epoch 015 - training loss (MAE): 0.5510, validation MSE: 1.1694
2025-08-23 11:22:21 [INFO]: Finished training. The best model is from epoch#15.
2025-08-23 11:22:21 [INFO]: Saved the model to output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/TimeMixerPP.pypots
[TimeMixer++] Testing —— MAE: 0.5410| MSE: 0.4678| RMSE: 0.6839| MRE: 0.6983|
📊 Metrics saved to: output/imputation/cuda/timemixerpp/solar_alabama/epoch15/mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3/metrics/timemixerpp_metrics.json
✅ DONE: solar_alabama | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindtrue_dly1_dwin1
⏭️  Skip (done): solar_alabama | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixtrue_cindfalse_dly1_dwin1
⏭️  Skip (done): solar_alabama | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindtrue_dly1_dwin1
⏭️  Skip (done): solar_alabama | mr0.5_bs32_dm64_ffn64_h2_ly1_topk5_kernels3_cmixfalse_cindfalse_dly1_dwin1
✅ All timemixerpp runs completed at 2025-08-23T11:22:25+09:00.
