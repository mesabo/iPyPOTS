ai-gpgpu14
Visible GPUs (physical): 0,1,2,3,4,5,6,7
Using devices (logical): cuda:2
Session log: output/imputation/cuda/session_llmsaits_20250824T125007.log
🔥 RUN: llmsaits | physionet_2012 | mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_prompttrue_reprogtrue (DEVICE=cuda:2, N_STEPS=48, N_FEATURES=35)
/var/spool/slurm-llnl/slurmd/job04746/slurm_script: line 160: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogtrue/logs/run_mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_prompttrue_reprogtrue.log: No such file or directory
/var/spool/slurm-llnl/slurmd/job04746/slurm_script: line 161: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogtrue/logs/run_mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_prompttrue_reprogtrue.log: No such file or directory
/var/spool/slurm-llnl/slurmd/job04746/slurm_script: line 161: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogtrue/logs/run_mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_prompttrue_reprogtrue.log: No such file or directory
/var/spool/slurm-llnl/slurmd/job04746/slurm_script: line 162: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogtrue/logs/run_mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_prompttrue_reprogtrue.log: No such file or directory
tee: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogtrue/logs/run_mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_prompttrue_reprogtrue.log: No such file or directory
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-24 12:50:19 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: llmsaits
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-24 12:50:19 [INFO]: You're using dataset physionet_2012, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/physionet_2012
2025-08-24 12:50:19 [INFO]: Dataset physionet_2012 has already been downloaded. Processing directly...
2025-08-24 12:50:19 [INFO]: Dataset physionet_2012 has already been cached. Loading from cache directly...
2025-08-24 12:50:19 [INFO]: Loaded successfully!
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/physionet_2012.py:109: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  X = X.groupby("RecordID").apply(apply_func)
2025-08-24 12:50:26 [WARNING]: Note that physionet_2012 has sparse observations in the time series, hence we don't add additional missing values to the training dataset. 
2025-08-24 12:50:26 [INFO]: 22947 values masked out in the val set as ground truth, take 9.91% of the original observed values
2025-08-24 12:50:26 [INFO]: 28724 values masked out in the test set as ground truth, take 10.08% of the original observed values
2025-08-24 12:50:26 [INFO]: Total sample number: 3997
2025-08-24 12:50:26 [INFO]: Training set size: 2557 (63.97%)
2025-08-24 12:50:26 [INFO]: Validation set size: 640 (16.01%)
2025-08-24 12:50:26 [INFO]: Test set size: 800 (20.02%)
2025-08-24 12:50:26 [INFO]: Number of steps: 48
2025-08-24 12:50:26 [INFO]: Number of features: 37
2025-08-24 12:50:26 [INFO]: Train set missing rate: 79.68%
2025-08-24 12:50:26 [INFO]: Validating set missing rate: 81.65%
✅ Dataset 'physionet_2012' with missing rate 0.1 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.1
🚀 Starting LLMSAITS training pipeline...
2025-08-24 12:50:26 [INFO]: Test set missing rate: 81.96%
2025-08-24 12:50:26 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:2']
2025-08-24 12:50:26 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: cuda:2
2025-08-24 12:50:26 [INFO]: Model files will be saved to output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogtrue
2025-08-24 12:50:26 [INFO]: Tensorboard file will be saved to output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogtrue/tensorboard
2025-08-24 12:50:26 [INFO]: Using customized MAE as the training loss function.
2025-08-24 12:50:26 [INFO]: Using customized MSE as the validation metric function.
2025-08-24 12:50:28 [INFO]: Model placed on cuda:2
2025-08-24 12:50:28 [INFO]: LLMSAITS initialized with the given hyperparameters.
 ├─ Total parameters: 130,603,543
 ├─ Trainable parameters: 6,163,735
 └─ Trainable ratio: 4.72%
2025-08-24 12:53:08 [INFO]: Epoch 001 - training loss (MAE): 0.8571, validation MSE: 0.5122
2025-08-24 12:53:10 [ERROR]: ❌ Exception: CUDA out of memory. Tried to allocate 1.73 GiB. GPU 2 has a total capacity of 23.58 GiB of which 1.50 GiB is free. Including non-PyTorch memory, this process has 22.07 GiB memory in use. Of the allocated memory 20.13 GiB is allocated by PyTorch, and 1.62 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-24 12:53:10 [INFO]: Finished training. The best model is from epoch#1.
2025-08-24 12:53:11 [INFO]: Saved the model to output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogtrue/LLMSAITS.pypots
[LLMSAITS] Testing —— MAE: 0.4178| MSE: 0.4683| RMSE: 0.6843| MRE: 0.5868| 
📊 Metrics saved to: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogtrue/metrics/llmsaits_metrics.json
✅ DONE: physionet_2012 | mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_prompttrue_reprogtrue
🔥 RUN: llmsaits | physionet_2012 | mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_prompttrue_reprogfalse (DEVICE=cuda:2, N_STEPS=48, N_FEATURES=35)
/var/spool/slurm-llnl/slurmd/job04746/slurm_script: line 160: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogfalse/logs/run_mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_prompttrue_reprogfalse.log: No such file or directory
/var/spool/slurm-llnl/slurmd/job04746/slurm_script: line 161: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogfalse/logs/run_mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_prompttrue_reprogfalse.log: No such file or directory
/var/spool/slurm-llnl/slurmd/job04746/slurm_script: line 161: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogfalse/logs/run_mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_prompttrue_reprogfalse.log: No such file or directory
/var/spool/slurm-llnl/slurmd/job04746/slurm_script: line 162: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogfalse/logs/run_mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_prompttrue_reprogfalse.log: No such file or directory
tee: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogfalse/logs/run_mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_prompttrue_reprogfalse.log: No such file or directory
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
🚀 Running imputation pipeline for model: llmsaits
2025-08-24 12:54:09 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-24 12:54:09 [INFO]: You're using dataset physionet_2012, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/physionet_2012
2025-08-24 12:54:09 [INFO]: Dataset physionet_2012 has already been downloaded. Processing directly...
2025-08-24 12:54:09 [INFO]: Dataset physionet_2012 has already been cached. Loading from cache directly...
2025-08-24 12:54:09 [INFO]: Loaded successfully!
/home/23r8105_messou/anaconda3/envs/pypots/lib/python3.12/site-packages/benchpots/datasets/physionet_2012.py:109: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  X = X.groupby("RecordID").apply(apply_func)
2025-08-24 12:54:18 [WARNING]: Note that physionet_2012 has sparse observations in the time series, hence we don't add additional missing values to the training dataset. 
2025-08-24 12:54:18 [INFO]: 22947 values masked out in the val set as ground truth, take 9.91% of the original observed values
2025-08-24 12:54:18 [INFO]: 28724 values masked out in the test set as ground truth, take 10.08% of the original observed values
2025-08-24 12:54:18 [INFO]: Total sample number: 3997
2025-08-24 12:54:18 [INFO]: Training set size: 2557 (63.97%)
2025-08-24 12:54:18 [INFO]: Validation set size: 640 (16.01%)
2025-08-24 12:54:18 [INFO]: Test set size: 800 (20.02%)
2025-08-24 12:54:18 [INFO]: Number of steps: 48
2025-08-24 12:54:18 [INFO]: Number of features: 37
2025-08-24 12:54:18 [INFO]: Train set missing rate: 79.68%
2025-08-24 12:54:18 [INFO]: Validating set missing rate: 81.65%
2025-08-24 12:54:18 [INFO]: Test set missing rate: 81.96%
✅ Dataset 'physionet_2012' with missing rate 0.1 loaded at: /home/23r8105_messou/lab/iPyPOTS/datasets/rate_0.1
🚀 Starting LLMSAITS training pipeline...
2025-08-24 12:54:18 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using device list: ['cuda:2']
2025-08-24 12:54:18 [INFO]: 🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥Using the given device: cuda:2
2025-08-24 12:54:19 [INFO]: Model files will be saved to output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogfalse
2025-08-24 12:54:19 [INFO]: Tensorboard file will be saved to output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogfalse/tensorboard
2025-08-24 12:54:19 [INFO]: Using customized MAE as the training loss function.
2025-08-24 12:54:19 [INFO]: Using customized MSE as the validation metric function.
2025-08-24 12:54:21 [INFO]: Model placed on cuda:2
2025-08-24 12:54:21 [INFO]: LLMSAITS initialized with the given hyperparameters.
 ├─ Total parameters: 130,603,543
 ├─ Trainable parameters: 6,163,735
 └─ Trainable ratio: 4.72%
2025-08-24 12:57:02 [INFO]: Epoch 001 - training loss (MAE): 0.8571, validation MSE: 0.5122
2025-08-24 12:57:03 [ERROR]: ❌ Exception: CUDA out of memory. Tried to allocate 1.73 GiB. GPU 2 has a total capacity of 23.58 GiB of which 1.50 GiB is free. Including non-PyTorch memory, this process has 22.07 GiB memory in use. Of the allocated memory 20.13 GiB is allocated by PyTorch, and 1.62 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-24 12:57:03 [INFO]: Finished training. The best model is from epoch#1.
2025-08-24 12:57:05 [INFO]: Saved the model to output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogfalse/LLMSAITS.pypots
[LLMSAITS] Testing —— MAE: 0.4178| MSE: 0.4683| RMSE: 0.6843| MRE: 0.5868| 
📊 Metrics saved to: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/prompttrue_reprogfalse/metrics/llmsaits_metrics.json
✅ DONE: physionet_2012 | mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_prompttrue_reprogfalse
🔥 RUN: llmsaits | physionet_2012 | mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_promptfalse_reprogtrue (DEVICE=cuda:2, N_STEPS=48, N_FEATURES=35)
/var/spool/slurm-llnl/slurmd/job04746/slurm_script: line 160: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/promptfalse_reprogtrue/logs/run_mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_promptfalse_reprogtrue.log: No such file or directory
/var/spool/slurm-llnl/slurmd/job04746/slurm_script: line 161: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/promptfalse_reprogtrue/logs/run_mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_promptfalse_reprogtrue.log: No such file or directory
/var/spool/slurm-llnl/slurmd/job04746/slurm_script: line 161: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/promptfalse_reprogtrue/logs/run_mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_promptfalse_reprogtrue.log: No such file or directory
/var/spool/slurm-llnl/slurmd/job04746/slurm_script: line 162: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/promptfalse_reprogtrue/logs/run_mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_promptfalse_reprogtrue.log: No such file or directory
tee: output/imputation/cuda/llmsaits/gpt2/physionet_2012/epoch15/mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue/promptfalse_reprogtrue/logs/run_mr0.1_bs32_dm64_ffn128/h6_ly1/hanntrue_promptfalse_reprogtrue.log: No such file or directory
[34m
████████╗██╗███╗   ███╗███████╗    ███████╗███████╗██████╗ ██╗███████╗███████╗    █████╗ ██╗
╚══██╔══╝██║████╗ ████║██╔════╝    ██╔════╝██╔════╝██╔══██╗██║██╔════╝██╔════╝   ██╔══██╗██║
   ██║   ██║██╔████╔██║█████╗█████╗███████╗█████╗  ██████╔╝██║█████╗  ███████╗   ███████║██║
   ██║   ██║██║╚██╔╝██║██╔══╝╚════╝╚════██║██╔══╝  ██╔══██╗██║██╔══╝  ╚════██║   ██╔══██║██║
   ██║   ██║██║ ╚═╝ ██║███████╗    ███████║███████╗██║  ██║██║███████╗███████║██╗██║  ██║██║
   ╚═╝   ╚═╝╚═╝     ╚═╝╚══════╝    ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝╚══════╝╚═╝╚═╝  ╚═╝╚═╝
ai4ts v0.0.3 - building AI for unified time-series analysis, https://time-series.ai [0m

Use Train GPT: False
Use Lora: False
Use Profiling: False
2025-08-24 12:57:49 [INFO]: Have set the random seed as 2025 for numpy and pytorch.
🚀 Running imputation pipeline for model: llmsaits
ℹ️ TSDB migration not needed, directory exists: /home/23r8105_messou/lab/iPyPOTS/datasets
2025-08-24 12:57:49 [INFO]: You're using dataset physionet_2012, please cite it properly in your work. You can find its reference information at the below link: 
https://github.com/WenjieDu/TSDB/tree/main/dataset_profiles/physionet_2012
2025-08-24 12:57:49 [INFO]: Dataset physionet_2012 has already been downloaded. Processing directly...
2025-08-24 12:57:49 [INFO]: Dataset physionet_2012 has already been cached. Loading from cache directly...
2025-08-24 12:57:49 [INFO]: Loaded successfully!
slurmstepd-ai-gpgpu14: error: *** JOB 4746 ON ai-gpgpu14 CANCELLED AT 2025-08-24T12:57:56 ***
